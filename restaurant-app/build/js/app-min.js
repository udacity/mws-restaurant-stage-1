"use strict";const API_URL="http://localhost:1337/restaurants";let restaurants,neighborhoods,cuisines,fetchStatus=0;class IDbOperationsHelper{static checkForIDbSupport(){return"indexedDB"in window?1:0}static openIDb(e,t,n){return idb.open(e,t,e=>{e.createObjectStore(n,{autoIncrement:!0})})}static addToDb(e,t,n,r){e.then(e=>{const a=e.transaction(t,n);return a.objectStore(t).put(r),a.complete}).then(e=>{console.log("Restaurant saved to IDb")})}static getAllData(e,t,n){e.then(e=>e.transaction(t).objectStore(n).getAll()).then(e=>{IDbOperationsHelper.setRestaurantsData(e)})}static getRestaurantsFromServer(e,t,n,r){fetch(API_URL).then(e=>e.json()).then(a=>{a.forEach(e=>{e=IDbOperationsHelper.addMissingData(e)}),1!=fetchStatus&&(fetchStatus=1,a.forEach(r=>{IDbOperationsHelper.addToDb(e,t,n,r)})),console.log(a),r(null,a)}).catch(e=>{console.log(`Unable to fetch restaurants, Error: ${e}`),r(e,null)})}static getRestaurantsData(e){let t=IDbOperationsHelper.openIDb("restaurants-data",1,"restaurants");t.then(e=>e.transaction("restaurants").objectStore("restaurants").getAll()).then(n=>{n.length<=0?IDbOperationsHelper.getRestaurantsFromServer(t,"restaurants","readwrite",e):e(null,n)})}static addMissingData(e){return isNaN(e.photograph)?e.photograph=e.id+".jpg":e.photograph=e.photograph+".jpg",e}}class DBHelper{static get NEW_URL(){return"http://localhost:1337/restaurants"}static fetchRestaurantById(e,t){IDbOperationsHelper.getRestaurantsData((n,r)=>{if(n)t(n,null);else{const n=r.find(t=>t.id==e);n?t(null,n):t("Restaurant does not exist",null)}})}static fetchRestaurantByCuisine(e,t){IDbOperationsHelper.getRestaurantsData((n,r)=>{if(n)t(n,null);else{const n=r.filter(t=>t.cuisine_type==e);t(null,n)}})}static fetchRestaurantByNeighborhood(e,t){IDbOperationsHelper.getRestaurantsData((n,r)=>{if(n)t(n,null);else{const n=r.filter(t=>t.neighborhood==e);t(null,n)}})}static fetchRestaurantByCuisineAndNeighborhood(e,t,n){IDbOperationsHelper.getRestaurantsData((r,a)=>{if(r)n(r,null);else{let r=a;"all"!=e&&(r=r.filter(t=>t.cuisine_type==e)),"all"!=t&&(r=r.filter(e=>e.neighborhood==t)),n(null,r)}})}static fetchNeighborhoods(e){IDbOperationsHelper.getRestaurantsData((t,n)=>{if(t)e(t,null);else{const t=n.map((e,t)=>n[t].neighborhood),r=t.filter((e,n)=>t.indexOf(e)==n);e(null,r)}})}static fetchCuisines(e){IDbOperationsHelper.getRestaurantsData((t,n)=>{if(t)e(t,null);else{const t=n.map((e,t)=>n[t].cuisine_type),r=t.filter((e,n)=>t.indexOf(e)==n);e(null,r)}})}static urlForRestaurant(e){return`./restaurant.html?id=${e.id}`}static imageUrlForRestaurant(e){return`/img/${e.photograph}`}static mapMarkerForRestaurant(e,t){const n=new L.marker([e.latlng.lat,e.latlng.lng],{title:e.name,alt:e.name,url:DBHelper.urlForRestaurant(e)});return n.addTo(newMap),n}}!function(){function e(e){return new Promise(function(t,n){e.onsuccess=function(){t(e.result)},e.onerror=function(){n(e.error)}})}function t(t,n,r){var a,o=new Promise(function(o,s){e(a=t[n].apply(t,r)).then(o,s)});return o.request=a,o}function n(e,t,n){n.forEach(function(n){Object.defineProperty(e.prototype,n,{get:function(){return this[t][n]},set:function(e){this[t][n]=e}})})}function r(e,n,r,a){a.forEach(function(a){a in r.prototype&&(e.prototype[a]=function(){return t(this[n],a,arguments)})})}function a(e,t,n,r){r.forEach(function(r){r in n.prototype&&(e.prototype[r]=function(){return this[t][r].apply(this[t],arguments)})})}function o(e,n,r,a){a.forEach(function(a){a in r.prototype&&(e.prototype[a]=function(){return e=this[n],(r=t(e,a,arguments)).then(function(e){if(e)return new i(e,r.request)});var e,r})})}function s(e){this._index=e}function i(e,t){this._cursor=e,this._request=t}function c(e){this._store=e}function l(e){this._tx=e,this.complete=new Promise(function(t,n){e.oncomplete=function(){t()},e.onerror=function(){n(e.error)},e.onabort=function(){n(e.error)}})}function u(e,t,n){this._db=e,this.oldVersion=t,this.transaction=new l(n)}function p(e){this._db=e}n(s,"_index",["name","keyPath","multiEntry","unique"]),r(s,"_index",IDBIndex,["get","getKey","getAll","getAllKeys","count"]),o(s,"_index",IDBIndex,["openCursor","openKeyCursor"]),n(i,"_cursor",["direction","key","primaryKey","value"]),r(i,"_cursor",IDBCursor,["update","delete"]),["advance","continue","continuePrimaryKey"].forEach(function(t){t in IDBCursor.prototype&&(i.prototype[t]=function(){var n=this,r=arguments;return Promise.resolve().then(function(){return n._cursor[t].apply(n._cursor,r),e(n._request).then(function(e){if(e)return new i(e,n._request)})})})}),c.prototype.createIndex=function(){return new s(this._store.createIndex.apply(this._store,arguments))},c.prototype.index=function(){return new s(this._store.index.apply(this._store,arguments))},n(c,"_store",["name","keyPath","indexNames","autoIncrement"]),r(c,"_store",IDBObjectStore,["put","add","delete","clear","get","getAll","getKey","getAllKeys","count"]),o(c,"_store",IDBObjectStore,["openCursor","openKeyCursor"]),a(c,"_store",IDBObjectStore,["deleteIndex"]),l.prototype.objectStore=function(){return new c(this._tx.objectStore.apply(this._tx,arguments))},n(l,"_tx",["objectStoreNames","mode"]),a(l,"_tx",IDBTransaction,["abort"]),u.prototype.createObjectStore=function(){return new c(this._db.createObjectStore.apply(this._db,arguments))},n(u,"_db",["name","version","objectStoreNames"]),a(u,"_db",IDBDatabase,["deleteObjectStore","close"]),p.prototype.transaction=function(){return new l(this._db.transaction.apply(this._db,arguments))},n(p,"_db",["name","version","objectStoreNames"]),a(p,"_db",IDBDatabase,["close"]),["openCursor","openKeyCursor"].forEach(function(e){[c,s].forEach(function(t){e in t.prototype&&(t.prototype[e.replace("open","iterate")]=function(){var t,n=(t=arguments,Array.prototype.slice.call(t)),r=n[n.length-1],a=this._store||this._index,o=a[e].apply(a,n.slice(0,-1));o.onsuccess=function(){r(o.result)}})})}),[s,c].forEach(function(e){e.prototype.getAll||(e.prototype.getAll=function(e,t){var n=this,r=[];return new Promise(function(a){n.iterateCursor(e,function(e){e?(r.push(e.value),void 0===t||r.length!=t?e.continue():a(r)):a(r)})})})});var d={open:function(e,n,r){var a=t(indexedDB,"open",[e,n]),o=a.request;return o&&(o.onupgradeneeded=function(e){r&&r(new u(o.result,e.oldVersion,o.transaction))}),a.then(function(e){return new p(e)})},delete:function(e){return t(indexedDB,"deleteDatabase",[e])}};"undefined"!=typeof module?(module.exports=d,module.exports.default=module.exports):self.idb=d}(),navigator.serviceWorker&&navigator.serviceWorker.register("/sw.js").then(function(e){console.log("Worker registered!")}).catch(function(e){console.log(e)});var markers=[];let restaurant;var newMap;document.addEventListener("DOMContentLoaded",e=>{initMap(),fetchNeighborhoods(),fetchCuisines()}),fetchNeighborhoods=(()=>{DBHelper.fetchNeighborhoods((e,t)=>{e?console.error(e):(self.neighborhoods=t,fillNeighborhoodsHTML())})}),fillNeighborhoodsHTML=((e=self.neighborhoods)=>{const t=document.getElementById("neighborhoods-select");e.forEach(e=>{const n=document.createElement("option");n.innerHTML=e,n.value=e,t.append(n)})}),fetchCuisines=(()=>{DBHelper.fetchCuisines((e,t)=>{e?console.error(e):(self.cuisines=t,fillCuisinesHTML())})}),fillCuisinesHTML=((e=self.cuisines)=>{const t=document.getElementById("cuisines-select");e.forEach(e=>{const n=document.createElement("option");n.innerHTML=e,n.value=e,t.append(n)})}),initMap=(()=>{self.newMap=L.map("map",{center:[40.722216,-73.987501],zoom:12,scrollWheelZoom:!1}),L.tileLayer("https://api.tiles.mapbox.com/v4/{id}/{z}/{x}/{y}.jpg70?access_token={mapboxToken}",{mapboxToken:"pk.eyJ1IjoiaW12cG4yMiIsImEiOiJjaml2bnlycGExM3FuM3FxbTc0eWM2NHV2In0.ESs374xN3guFAGO_1EPdmQ",maxZoom:18,attribution:'Map data &copy; <a href="https://www.openstreetmap.org/">OpenStreetMap</a> contributors, <a href="https://creativecommons.org/licenses/by-sa/2.0/">CC-BY-SA</a>, Imagery © <a href="https://www.mapbox.com/">Mapbox</a>',id:"mapbox.streets"}).addTo(newMap),updateRestaurants()}),updateRestaurants=(()=>{const e=document.getElementById("cuisines-select"),t=document.getElementById("neighborhoods-select"),n=e.selectedIndex,r=t.selectedIndex,a=e[n].value,o=t[r].value;DBHelper.fetchRestaurantByCuisineAndNeighborhood(a,o,(e,t)=>{e?console.error(e):(resetRestaurants(t),fillRestaurantsHTML())})}),resetRestaurants=(e=>{self.restaurants=[],document.getElementById("restaurants-list").innerHTML="",self.markers&&self.markers.forEach(e=>e.remove()),self.markers=[],self.restaurants=e}),fillRestaurantsHTML=((e=self.restaurants)=>{const t=document.getElementById("restaurants-list");e.forEach(e=>{t.append(createRestaurantHTML(e))}),addMarkersToMap()}),createRestaurantHTML=(e=>{const t=document.createElement("li");t.setAttribute("tabindex",0);const n=document.createElement("img");n.src=DBHelper.imageUrlForRestaurant(e),n.className="restaurant-img","http://localhost:8080/no-image"==n.src&&(n.src="",n.classList.add("fallback-image-icon")),n.alt=`${e.name} restaurant image`,n.setAttribute("tabindex",0),t.append(n);const r=document.createElement("div");r.className="restaurant-details",t.append(r);const a=document.createElement("h2");a.innerHTML=e.name,a.setAttribute("tabindex",0),r.append(a);const o=document.createElement("p");o.innerHTML=e.neighborhood,o.setAttribute("tabindex",0),r.append(o);const s=document.createElement("p");s.className="rest-address",s.innerHTML="<i class='fa fa-map-marker'></i>"+e.address,s.setAttribute("tabindex",0),r.append(s);const i=document.createElement("a");return i.innerHTML="View Details",i.href=DBHelper.urlForRestaurant(e),i.setAttribute("aria-label",`View details of ${e.name}`),r.append(i),t}),addMarkersToMap=((e=self.restaurants)=>{e.forEach(e=>{const t=DBHelper.mapMarkerForRestaurant(e,self.newMap);t.on("click",function(){window.location.href=t.options.url}),self.markers.push(t)})}),document.addEventListener("DOMContentLoaded",e=>{initMap()}),initMap=(()=>{fetchRestaurantFromURL((e,t)=>{e?console.error(e):(self.newMap=L.map("map",{center:[t.latlng.lat,t.latlng.lng],zoom:16,scrollWheelZoom:!1}),L.tileLayer("https://api.tiles.mapbox.com/v4/{id}/{z}/{x}/{y}.jpg70?access_token={mapboxToken}",{mapboxToken:"pk.eyJ1IjoiaW12cG4yMiIsImEiOiJjaml2bnlycGExM3FuM3FxbTc0eWM2NHV2In0.ESs374xN3guFAGO_1EPdmQ",maxZoom:18,attribution:'Map data &copy; <a href="https://www.openstreetmap.org/">OpenStreetMap</a> contributors, <a href="https://creativecommons.org/licenses/by-sa/2.0/">CC-BY-SA</a>, Imagery © <a href="https://www.mapbox.com/">Mapbox</a>',id:"mapbox.streets"}).addTo(newMap),fillBreadcrumb(),DBHelper.mapMarkerForRestaurant(self.restaurant,self.newMap))})}),fetchRestaurantFromURL=(e=>{if(self.restaurant)return void e(null,self.restaurant);const t=getParameterByName("id");t?DBHelper.fetchRestaurantById(t,(t,n)=>{self.restaurant=n,n?(fillRestaurantHTML(),e(null,n)):console.error(t)}):(error="No restaurant id in URL",e(error,null))}),fillRestaurantHTML=((e=self.restaurant)=>{document.getElementById("restaurant-name").innerHTML=e.name,document.getElementById("restaurant-address").innerHTML="<i class='fa fa-map-marker'></i>"+e.address;const t=document.getElementById("restaurant-img");t.className="restaurant-img",t.src=DBHelper.imageUrlForRestaurant(e),"http://localhost:8080/no-image"==t.src&&t.classList.add("fallback-image-icon"),t.alt=`${e.name} restaurant image`,document.getElementById("restaurant-cuisine").innerHTML=e.cuisine_type,e.operating_hours&&fillRestaurantHoursHTML(),fillReviewsHTML()}),fillRestaurantHoursHTML=((e=self.restaurant.operating_hours)=>{const t=document.getElementById("restaurant-hours");for(let n in e){const r=document.createElement("tr"),a=document.createElement("td");a.innerHTML=n,r.appendChild(a);const o=document.createElement("td");o.innerHTML=e[n],r.appendChild(o),t.appendChild(r)}}),fillReviewsHTML=((e=self.restaurant.reviews)=>{const t=document.getElementById("reviews-container"),n=document.createElement("h2");if(n.innerHTML="Reviews",n.setAttribute("tabindex",0),t.appendChild(n),!e){const e=document.createElement("p");return e.innerHTML="No reviews yet!",e.setAttribute("tabindex",0),void t.appendChild(e)}const r=document.getElementById("reviews-list");e.forEach(e=>{r.appendChild(createReviewHTML(e))}),t.appendChild(r)}),createReviewHTML=(e=>{const t=document.createElement("li");t.setAttribute("tabindex",0);const n=document.createElement("p");n.className="review-user",n.innerHTML="<i class='fa fa-user'></i>"+e.name,n.setAttribute("tabindex",0),t.appendChild(n);const r=document.createElement("p");r.className="review-date",r.innerHTML="<i class='fa fa-calendar'></i>"+e.date,r.setAttribute("tabindex",0),t.appendChild(r);const a=document.createElement("p");for(a.className="review-rating",a.innerHTML="",a.setAttribute("tabindex",0),a.setAttribute("aria-label",`Rating: ${e.rating} out of 5 stars`),i=0;i<e.rating;i++){let e=document.createElement("i");e.className="fa fa-star",a.appendChild(e)}for(i=e.rating;i<5;i++){let e=document.createElement("i");e.className="far fa-star",a.appendChild(e)}t.appendChild(a);const o=document.createElement("p");return o.className="review-comments",o.innerHTML=e.comments,o.setAttribute("tabindex",0),t.appendChild(o),t}),fillBreadcrumb=((e=self.restaurant)=>{const t=document.getElementById("breadcrumb"),n=document.createElement("li");n.innerHTML=e.name,t.appendChild(n)}),getParameterByName=((e,t)=>{t||(t=window.location.href),e=e.replace(/[\[\]]/g,"\\$&");const n=new RegExp(`[?&]${e}(=([^&#]*)|&|#|$)`).exec(t);return n?n[2]?decodeURIComponent(n[2].replace(/\+/g," ")):"":null});
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIklEYk9wZXJhdGlvbnNIZWxwZXIuanMiLCJkYmhlbHBlci5qcyIsImlkYi5qcyIsImluZGV4Q29udHJvbGxlci5qcyIsIm1haW4uanMiLCJyZXN0YXVyYW50SW5mby5qcyJdLCJuYW1lcyI6WyJBUElfVVJMIiwicmVzdGF1cmFudHMiLCJuZWlnaGJvcmhvb2RzIiwiY3Vpc2luZXMiLCJmZXRjaFN0YXR1cyIsIklEYk9wZXJhdGlvbnNIZWxwZXIiLCJbb2JqZWN0IE9iamVjdF0iLCJ3aW5kb3ciLCJuYW1lIiwidmVyc2lvbiIsIm9iamVjdFN0b3JlTmFtZSIsImlkYiIsIm9wZW4iLCJ1cGdyYWRlREIiLCJjcmVhdGVPYmplY3RTdG9yZSIsImF1dG9JbmNyZW1lbnQiLCJkYlByb21pc2UiLCJwZXJtaXNpb24iLCJqc29uRGF0YSIsInRoZW4iLCJkYiIsInRyYW5zYWN0IiwidHJhbnNhY3Rpb24iLCJvYmplY3RTdG9yZSIsInB1dCIsImNvbXBsZXRlIiwicmVzcG9uc2UiLCJjb25zb2xlIiwibG9nIiwidHJhbnNhY3Rpb25OYW1lIiwiZ2V0QWxsIiwiYXJyeSIsInNldFJlc3RhdXJhbnRzRGF0YSIsImNhbGxiYWNrIiwiZmV0Y2giLCJqc29uIiwicmVzcG9uc2VKc29uIiwiZm9yRWFjaCIsInJlc3RhdXJhbnQiLCJhZGRNaXNzaW5nRGF0YSIsInJlc3RhdXJhbnREYXRhIiwiYWRkVG9EYiIsImNhdGNoIiwiZXJyb3IiLCJvcGVuSURiIiwicmVzcG9uc2VPYmVqY3RzIiwibGVuZ3RoIiwiZ2V0UmVzdGF1cmFudHNGcm9tU2VydmVyIiwicmVzdEpzb24iLCJpc05hTiIsInBob3RvZ3JhcGgiLCJpZCIsIkRCSGVscGVyIiwiTkVXX1VSTCIsImdldFJlc3RhdXJhbnRzRGF0YSIsImZpbmQiLCJyIiwiY3Vpc2luZSIsInJlc3VsdHMiLCJmaWx0ZXIiLCJjdWlzaW5lX3R5cGUiLCJuZWlnaGJvcmhvb2QiLCJtYXAiLCJ2IiwiaSIsInVuaXF1ZU5laWdoYm9yaG9vZHMiLCJpbmRleE9mIiwidW5pcXVlQ3Vpc2luZXMiLCJtYXJrZXIiLCJMIiwibGF0bG5nIiwibGF0IiwibG5nIiwidGl0bGUiLCJhbHQiLCJ1cmwiLCJ1cmxGb3JSZXN0YXVyYW50IiwiYWRkVG8iLCJuZXdNYXAiLCJwcm9taXNpZnlSZXF1ZXN0IiwicmVxdWVzdCIsIlByb21pc2UiLCJyZXNvbHZlIiwicmVqZWN0Iiwib25zdWNjZXNzIiwicmVzdWx0Iiwib25lcnJvciIsInByb21pc2lmeVJlcXVlc3RDYWxsIiwib2JqIiwibWV0aG9kIiwiYXJncyIsInAiLCJhcHBseSIsInByb3h5UHJvcGVydGllcyIsIlByb3h5Q2xhc3MiLCJ0YXJnZXRQcm9wIiwicHJvcGVydGllcyIsInByb3AiLCJPYmplY3QiLCJkZWZpbmVQcm9wZXJ0eSIsInByb3RvdHlwZSIsImdldCIsInRoaXMiLCJzZXQiLCJ2YWwiLCJwcm94eVJlcXVlc3RNZXRob2RzIiwiQ29uc3RydWN0b3IiLCJhcmd1bWVudHMiLCJwcm94eU1ldGhvZHMiLCJwcm94eUN1cnNvclJlcXVlc3RNZXRob2RzIiwidmFsdWUiLCJDdXJzb3IiLCJJbmRleCIsImluZGV4IiwiX2luZGV4IiwiY3Vyc29yIiwiX2N1cnNvciIsIl9yZXF1ZXN0IiwiT2JqZWN0U3RvcmUiLCJzdG9yZSIsIl9zdG9yZSIsIlRyYW5zYWN0aW9uIiwiaWRiVHJhbnNhY3Rpb24iLCJfdHgiLCJvbmNvbXBsZXRlIiwib25hYm9ydCIsIlVwZ3JhZGVEQiIsIm9sZFZlcnNpb24iLCJfZGIiLCJEQiIsIklEQkluZGV4IiwiSURCQ3Vyc29yIiwibWV0aG9kTmFtZSIsImNyZWF0ZUluZGV4IiwiSURCT2JqZWN0U3RvcmUiLCJJREJUcmFuc2FjdGlvbiIsIklEQkRhdGFiYXNlIiwiZnVuY05hbWUiLCJyZXBsYWNlIiwiYXJyIiwiQXJyYXkiLCJzbGljZSIsImNhbGwiLCJuYXRpdmVPYmplY3QiLCJxdWVyeSIsImNvdW50IiwiaW5zdGFuY2UiLCJpdGVtcyIsIml0ZXJhdGVDdXJzb3IiLCJwdXNoIiwidW5kZWZpbmVkIiwiY29udGludWUiLCJleHAiLCJ1cGdyYWRlQ2FsbGJhY2siLCJpbmRleGVkREIiLCJvbnVwZ3JhZGVuZWVkZWQiLCJldmVudCIsImRlbGV0ZSIsIm1vZHVsZSIsImV4cG9ydHMiLCJkZWZhdWx0Iiwic2VsZiIsIm5hdmlnYXRvciIsInNlcnZpY2VXb3JrZXIiLCJyZWdpc3RlciIsInJlZyIsImVyciIsIm1hcmtlcnMiLCJkb2N1bWVudCIsImFkZEV2ZW50TGlzdGVuZXIiLCJpbml0TWFwIiwiZmV0Y2hOZWlnaGJvcmhvb2RzIiwiZmV0Y2hDdWlzaW5lcyIsImZpbGxOZWlnaGJvcmhvb2RzSFRNTCIsInNlbGVjdCIsImdldEVsZW1lbnRCeUlkIiwib3B0aW9uIiwiY3JlYXRlRWxlbWVudCIsImlubmVySFRNTCIsImFwcGVuZCIsImZpbGxDdWlzaW5lc0hUTUwiLCJjZW50ZXIiLCJ6b29tIiwic2Nyb2xsV2hlZWxab29tIiwidGlsZUxheWVyIiwibWFwYm94VG9rZW4iLCJtYXhab29tIiwiYXR0cmlidXRpb24iLCJ1cGRhdGVSZXN0YXVyYW50cyIsImNTZWxlY3QiLCJuU2VsZWN0IiwiY0luZGV4Iiwic2VsZWN0ZWRJbmRleCIsIm5JbmRleCIsImZldGNoUmVzdGF1cmFudEJ5Q3Vpc2luZUFuZE5laWdoYm9yaG9vZCIsInJlc2V0UmVzdGF1cmFudHMiLCJmaWxsUmVzdGF1cmFudHNIVE1MIiwicmVtb3ZlIiwidWwiLCJjcmVhdGVSZXN0YXVyYW50SFRNTCIsImFkZE1hcmtlcnNUb01hcCIsImxpIiwic2V0QXR0cmlidXRlIiwiaW1hZ2UiLCJzcmMiLCJpbWFnZVVybEZvclJlc3RhdXJhbnQiLCJjbGFzc05hbWUiLCJjbGFzc0xpc3QiLCJhZGQiLCJkZXRhaWxzIiwiYWRkcmVzcyIsIm1vcmUiLCJocmVmIiwibWFwTWFya2VyRm9yUmVzdGF1cmFudCIsIm9uIiwibG9jYXRpb24iLCJvcHRpb25zIiwiZmV0Y2hSZXN0YXVyYW50RnJvbVVSTCIsImZpbGxCcmVhZGNydW1iIiwiZ2V0UGFyYW1ldGVyQnlOYW1lIiwiZmV0Y2hSZXN0YXVyYW50QnlJZCIsImZpbGxSZXN0YXVyYW50SFRNTCIsIm9wZXJhdGluZ19ob3VycyIsImZpbGxSZXN0YXVyYW50SG91cnNIVE1MIiwiZmlsbFJldmlld3NIVE1MIiwib3BlcmF0aW5nSG91cnMiLCJob3VycyIsImtleSIsInJvdyIsImRheSIsImFwcGVuZENoaWxkIiwidGltZSIsInJldmlld3MiLCJjb250YWluZXIiLCJub1Jldmlld3MiLCJyZXZpZXciLCJjcmVhdGVSZXZpZXdIVE1MIiwiZGF0ZSIsInJhdGluZyIsInN0YXIiLCJjb21tZW50cyIsImJyZWFkY3J1bWIiLCJSZWdFeHAiLCJleGVjIiwiZGVjb2RlVVJJQ29tcG9uZW50Il0sIm1hcHBpbmdzIjoiQUFBQSxhQUVBLE1BQU1BLFFBQVUsb0NBQ2hCLElBNmxCSUMsWUFDQUMsY0FDQUMsU0EvbEJBQyxZQUFjLEVBS2xCLE1BQU1DLG9CQUNGQyw0QkFDSSxNQUFNLGNBQWVDLE9BR1YsRUFGQSxFQU1mRCxlQUFlRSxFQUFNQyxFQUFTQyxHQUkxQixPQUhrQkMsSUFBSUMsS0FBS0osRUFBTUMsRUFBU0ksSUFDdENBLEVBQVVDLGtCQUFrQkosRUFBaUIsQ0FBRUssZUFBZSxNQUt0RVQsZUFBZVUsRUFBV04sRUFBaUJPLEVBQVdDLEdBQ2xERixFQUFVRyxLQUFLQyxJQUNYLE1BQU1DLEVBQVdELEVBQUdFLFlBQVlaLEVBQWlCTyxHQUdqRCxPQURBSSxFQUFTRSxZQUFZYixHQUFpQmMsSUFBSU4sR0FDbkNHLEVBQVNJLFdBQ2pCTixLQUFLTyxJQUNKQyxRQUFRQyxJQUFJLDZCQUlwQnRCLGtCQUFrQlUsRUFBV2EsRUFBaUJuQixHQUNmTSxFQUFVRyxLQUFLQyxHQUFNQSxFQUMzQ0UsWUFBWU8sR0FDWk4sWUFBWWIsR0FDWm9CLFVBRWdCWCxLQUFLWSxJQUN0QjFCLG9CQUFvQjJCLG1CQUFtQkQsS0FJL0N6QixnQ0FBZ0NVLEVBQVdOLEVBQWlCTyxFQUFXZ0IsR0FDbkVDLE1BQU1sQyxTQUNMbUIs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R0FDaENvQyxFQUFPcEMsYUFBYSx3QkFBeUJpQyxFQUFPRyx5QkFHL0M5SyxFQUFFLEVBQUdBLEVBQUUySyxFQUFPRyxPQUFROUssSUFBSyxDQUM1QixJQUFJK0ssRUFBT3ZFLFNBQVNTLGNBQWMsS0FDbEM4RCxFQUFLakMsVUFBWSxhQUNqQmdDLEVBQU9SLFlBQVlTLEdBRXZCLElBQUsvSyxFQUFFMkssRUFBT0csT0FBUTlLLEVBQUUsRUFBR0EsSUFBSyxDQUM1QixJQUFJK0ssRUFBT3ZFLFNBQVNTLGNBQWMsS0FDbEM4RCxFQUFLakMsVUFBWSxjQUNqQmdDLEVBQU9SLFlBQVlTLEdBRXZCdEMsRUFBRzZCLFlBQVlRLEdBRWYsTUFBTUUsRUFBV3hFLFNBQVNTLGNBQWMsS0FNeEMsT0FMQStELEVBQVNsQyxVQUFZLGtCQUNyQmtDLEVBQVM5RCxVQUFZeUQsRUFBT0ssU0FDNUJBLEVBQVN0QyxhQUFhLFdBQVksR0FDbENELEVBQUc2QixZQUFZVSxHQUVSdkMsSUFNWGlCLGVBQWlCLEVBQUNwTCxFQUFXMkgsS0FBSzNILGNBQzlCLE1BQU0yTSxFQUFhekUsU0FBU08sZUFBZSxjQUNyQzBCLEVBQUtqQyxTQUFTUyxjQUFjLE1BQ2xDd0IsRUFBR3ZCLFVBQVk1SSxFQUFXOUIsS0FDMUJ5TyxFQUFXWCxZQUFZN0IsS0FNM0JrQixtQkFBcUIsRUFBQ25OLEVBQU1tRSxLQUNuQkEsSUFDREEsRUFBTXBFLE9BQU9nTixTQUFTSCxNQUMxQjVNLEVBQU9BLEVBQUtrSSxRQUFRLFVBQVcsUUFDL0IsTUFDSWhGLEVBRFUsSUFBSXdMLGNBQWMxTyxzQkFDWjJPLEtBQUt4SyxHQUN6QixPQUFLakIsRUFFQUEsRUFBUSxHQUVOMEwsbUJBQW1CMUwsRUFBUSxHQUFHZ0YsUUFBUSxNQUFPLE1BRHpDLEdBRkEiLCJzb3VyY2VzQ29udGVudCI6WyIndXNlIHN0cmljdCc7XG5cbmNvbnN0IEFQSV9VUkwgPSAnaHR0cDovL2xvY2FsaG9zdDoxMzM3L3Jlc3RhdXJhbnRzJztcbmxldCBmZXRjaFN0YXR1cyA9IDA7XG5cbi8qXG4gKiBIZWxwZXIgRnVuY3Rpb25zIGZvciB2YXJpb3VzIElEYiBPcGVyYXRpb25zXG4gKi9cbmNsYXNzIElEYk9wZXJhdGlvbnNIZWxwZXIge1xuICAgIHN0YXRpYyBjaGVja0ZvcklEYlN1cHBvcnQoKSB7XG4gICAgICAgIGlmICghKCdpbmRleGVkREInIGluIHdpbmRvdykpIHtcbiAgICAgICAgICAgIHJldHVybiAwO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgcmV0dXJuIDE7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBzdGF0aWMgb3BlbklEYihuYW1lLCB2ZXJzaW9uLCBvYmplY3RTdG9yZU5hbWUpIHtcbiAgICAgICAgY29uc3QgZGJQcm9taXNlID0gaWRiLm9wZW4obmFtZSwgdmVyc2lvbiwgdXBncmFkZURCID0+IHtcbiAgICAgICAgICAgIHVwZ3JhZGVEQi5jcmVhdGVPYmplY3RTdG9yZShvYmplY3RTdG9yZU5hbWUsIHsgYXV0b0luY3JlbWVudDogdHJ1ZSB9KTtcbiAgICAgICAgfSk7XG4gICAgICAgIHJldHVybiBkYlByb21pc2U7XG4gICAgfVxuXG4gICAgc3RhdGljIGFkZFRvRGIoZGJQcm9taXNlLCBvYmplY3RTdG9yZU5hbWUsIHBlcm1pc2lvbiwganNvbkRhdGEpIHtcbiAgICAgICAgZGJQcm9taXNlLnRoZW4oZGIgPT4ge1xuICAgICAgICAgICAgY29uc3QgdHJhbnNhY3QgPSBkYi50cmFuc2FjdGlvbihvYmplY3RTdG9yZU5hbWUsIHBlcm1pc2lvbik7XG4gICAgICAgICAgICAvL0FkZCBhbGwgdGhlIGpzb24gY29udGVudCBoZXJlXG4gICAgICAgICAgICB0cmFuc2FjdC5vYmplY3RTdG9yZShvYmplY3RTdG9yZU5hbWUpLnB1dChqc29uRGF0YSk7XG4gICAgICAgICAgICByZXR1cm4gdHJhbnNhY3QuY29tcGxldGU7XG4gICAgICAgIH0pLnRoZW4ocmVzcG9uc2UgPT4ge1xuICAgICAgICAgICAgY29uc29sZS5sb2coJ1Jlc3RhdXJhbnQgc2F2ZWQgdG8gSURiJyk7XG4gICAgICAgIH0pO1xuICAgIH1cblxuICAgIHN0YXRpYyBnZXRBbGxEYXRhKGRiUHJvbWlzZSwgdHJhbnNhY3Rpb25OYW1lLCBvYmplY3RTdG9yZU5hbWUpIHtcbiAgICAgICAgbGV0IHJlc3BvbnNlQXJyYXlQcm9taXNlID0gZGJQcm9taXNlLnRoZW4oZGIgPT4gZGJcbiAgICAgICAgICAgIC50cmFuc2FjdGlvbih0cmFuc2FjdGlvbk5hbWUpXG4gICAgICAgICAgICAub2JqZWN0U3RvcmUob2JqZWN0U3RvcmVOYW1lKVxuICAgICAgICAgICAgLmdldEFsbCgpXG4gICAgICAgICAgICApO1xuICAgICAgICByZXNwb25zZUFycmF5UHJvbWlzZS50aGVuKGFycnkgPT4ge1xuICAgICAgICAgICAgSURiT3BlcmF0aW9uc0hlbHBlci5zZXRSZXN0YXVyYW50c0RhdGEoYXJyeSk7XG4gICAgICAgIH0pO1xuICAgIH1cblxuICAgIHN0YXRpYyBnZXRSZXN0YXVyYW50c0Zyb21TZXJ2ZXIoZGJQcm9taXNlLCBvYmplY3RTdG9yZU5hbWUsIHBlcm1pc2lvbiwgY2FsbGJhY2spIHtcbiAgICAgICAgZmV0Y2goQVBJX1VSTClcbiAgICAgICAgLnRoZW4ocmVzcG9uc2UgPT4gcmVzcG9uc2UuanNvbigpKVxuICAgICAgICAudGhlbihyZXNwb25zZUpzb24gPT4ge1xuICAgICAgICAgICAgcmVzcG9uc2VKc29uLmZvckVhY2gocmVzdGF1cmFudCA9PiB7XG4gICAgICAgICAgICAgICAgcmVzdGF1cmFudCA9IElEYk9wZXJhdGlvbnNIZWxwZXIuYWRkTWlzc2luZ0RhdGEocmVzdGF1cmFudClcbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICBpZiAoZmV0Y2hTdGF0dXMgIT0gMSkge1xuICAgICAgICAgICAgICAgIGZldGNoU3RhdHVzID0gMTtcbiAgICAgICAgICAgICAgICByZXNwb25zZUpzb24uZm9yRWFjaChyZXN0YXVyYW50RGF0YSA9PiB7XG5cbiAgICAgICAgICAgICAgICAgICAgLy9BZGQgZXZlcnkgc2luZ2xlIHJlc3RhdXJhbnQgZGF0YSB0byBJRGJcbiAgICAgICAgICAgICAgICAgICAgSURiT3BlcmF0aW9uc0hlbHBlci5hZGRUb0RiKFxuICAgICAgICAgICAgICAgICAgICAgICAgZGJQcm9taXNlLFxuICAgICAgICAgICAgICAgICAgICAgICAgb2JqZWN0U3RvcmVOYW1lLFxuICAgICAgICAgICAgICAgICAgICAgICAgcGVybWlzaW9uLFxuICAgICAgICAgICAgICAgICAgICAgICAgcmVzdGF1cmFudERhdGFcbiAgICAgICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgY29uc29sZS5sb2cocmVzcG9uc2VKc29uKTtcbiAgICAgICAgICAgIGNhbGxiYWNrIChudWxsLCByZXNwb25zZUpzb24pO1xuICAgICAgICB9KS5jYXRjaChlcnJvciA9PiB7XG4gICAgICAgICAgICBjb25zb2xlLmxvZyhgVW5hYmxlIHRvIGZldGNoIHJlc3RhdXJhbnRzLCBFcnJvcjogJHtlcnJvcn1gKTtcbiAgICAgICAgICAgIGNhbGxiYWNrIChlcnJvciwgbnVsbCk7XG4gICAgICAgIH0pO1xuICAgIH1cblxuICAgIHN0YXRpYyBnZXRSZXN0YXVyYW50c0RhdGEoY2FsbGJhY2spIHtcbiAgICAgICAgY29uc3QgaWRiTmFtZSA9ICdyZXN0YXVyYW50cy1kYXRhJztcbiAgICAgICAgY29uc3QgZGJWZXJzaW9uID0gMTtcbiAgICAgICAgY29uc3Qgb2JqZWN0U3RvcmVOYW1lU3RyaW5nID0gJ3Jlc3RhdXJhbnRzJztcbiAgICAgICAgY29uc3QgdHJhbnNhY3Rpb25OYW1lU3RyaW5nID0gJ3Jlc3RhdXJhbnRzJztcbiAgICAgICAgY29uc3QgZGJQZXJtaXNzaW9uID0gJ3JlYWR3cml0ZSc7XG5cbiAgICAgICAgbGV0IGRiUHJvbWlzZSA9IElEYk9wZXJhdGlvbnNIZWxwZXIub3BlbklEYihcbiAgICAgICAgICAgIGlkYk5hbWUsXG4gICAgICAgICAgICBkYlZlcnNpb24sXG4gICAgICAgICAgICBvYmplY3RTdG9yZU5hbWVTdHJpbmdcbiAgICAgICAgKTtcblxuICAgICAgICBkYlByb21pc2UudGhlbihkYiA9PlxuICAgICAgICAgICAgZGIudHJhbnNhY3Rpb24odHJhbnNhY3Rpb25OYW1lU3RyaW5nKVxuICAgICAgICAgICAgICAub2JqZWN0U3RvcmUob2JqZWN0U3RvcmVOYW1lU3RyaW5nKVxuICAgICAgICAgICAgICAuZ2V0QWxsKClcbiAgICAgICAgKS50aGVuKHJlc3BvbnNlT2JlamN0cyA9PiB7XG4gICAgICAgICAgICBpZiAocmVzcG9uc2VPYmVqY3RzLmxlbmd0aCA8PSAwKSB7XG4gICAgICAgICAgICAgICAgSURiT3BlcmF0aW9uc0hlbHBlci5nZXRSZXN0YXVyYW50c0Zyb21TZXJ2ZXIoXG4gICAgICAgICAgICAgICAgICAgIGRiUHJvbWlzZSxcbiAgICAgICAgICAgICAgICAgICAgb2JqZWN0U3RvcmVOYW1lU3RyaW5nLFxuICAgICAgICAgICAgICAgICAgICBkYlBlcm1pc3Npb24sXG4gICAgICAgICAgICAgICAgICAgIGNhbGxiYWNrXG4gICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgY2FsbGJhY2sobnVsbCwgcmVzcG9uc2VPYmVqY3RzKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgLy8gSGFuZGxlIGZvciBsYXN0IGVudHJ5IG9uIFJlc3RhdXJhbnRzIExpc3RcbiAgICBzdGF0aWMgYWRkTWlzc2luZ0RhdGEocmVzdEpzb24pIHtcbiAgICAgICAgaWYgKCFpc05hTihyZXN0SnNvbi5waG90b2dyYXBoKSkge1xuICAgICAgICAgICAgcmVzdEpzb24ucGhvdG9ncmFwaCA9IHJlc3RKc29uLnBob3RvZ3JhcGggKyAnLmpwZyc7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICByZXN0SnNvblsncGhvdG9ncmFwaCddID0gcmVzdEpzb24uaWQgKyAnLmpwZyc7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHJlc3RKc29uO1xuICAgIH1cbn1cbiIsIid1c2Ugc3RyaWN0JztcclxuXHJcbi8qKlxyXG4gKiBDb21tb24gZGF0YWJhc2UgaGVscGVyIGZ1bmN0aW9ucy5cclxuICovXHJcbiBjbGFzcyBEQkhlbHBlciB7XHJcbiAgLyoqXHJcbiAgICogRGF0YWJhc2UgVVJMLlxyXG4gICAqIENoYW5nZSB0aGlzIHRvIHJlc3RhdXJhbnRzLmpzb24gZmlsZSBsb2NhdGlvbiBvbiB5b3VyIHNlcnZlci5cclxuICAgKi9cclxuICAgc3RhdGljIGdldCBORVdfVVJMKCkge1xyXG4gICBcdHJldHVybiBgaHR0cDovL2xvY2FsaG9zdDoxMzM3L3Jlc3RhdXJhbnRzYDtcclxuICAgfVxyXG4gIC8qKlxyXG4gICAqIEZldGNoIGEgcmVzdGF1cmFudCBieSBpdHMgSUQuXHJcbiAgICovXHJcbiAgIHN0YXRpYyBmZXRjaFJlc3RhdXJhbnRCeUlkKGlkLCBjYWxsYmFjaykge1xyXG5cdC8vIGZldGNoIGFsbCByZXN0YXVyYW50cyB3aXRoIHByb3BlciBlcnJvciBoYW5kbGluZy5cclxuXHRJRGJPcGVyYXRpb25zSGVscGVyLmdldFJlc3RhdXJhbnRzRGF0YSgoZXJyb3IsIHJlc3RhdXJhbnRzKSA9PiB7XHJcblx0XHRpZiAoZXJyb3IpIHtcclxuXHRcdFx0Y2FsbGJhY2soZXJyb3IsIG51bGwpO1xyXG5cdFx0fSBlbHNlIHtcclxuXHRcdFx0Y29uc3QgcmVzdGF1cmFudCA9IHJlc3RhdXJhbnRzLmZpbmQociA9PiByLmlkID09IGlkKTtcclxuXHRcdFx0aWYgKHJlc3RhdXJhbnQpIHtcclxuXHRcdCAgLy8gR290IHRoZSByZXN0YXVyYW50XHJcblx0XHQgIGNhbGxiYWNrKG51bGwsIHJlc3RhdXJhbnQpO1xyXG5cdFx0fSBlbHNlIHtcclxuXHRcdCAgLy8gUmVzdGF1cmFudCBkb2VzIG5vdCBleGlzdCBpbiB0aGUgZGF0YWJhc2VcclxuXHRcdCAgY2FsbGJhY2soJ1Jlc3RhdXJhbnQgZG9lcyBub3QgZXhpc3QnLCBudWxsKTtcclxuXHRcdH1cclxuXHR9XHJcbn0pO1xyXG59XHJcblxyXG4gIC8qKlxyXG4gICAqIEZldGNoIHJlc3RhdXJhbnRzIGJ5IGEgY3Vpc2luZSB0eXBlIHdpdGggcHJvcGVyIGVycm9yIGhhbmRsaW5nLlxyXG4gICAqL1xyXG4gICBzdGF0aWMgZmV0Y2hSZXN0YXVyYW50QnlDdWlzaW5lKGN1aXNpbmUsIGNhbGxiYWNrKSB7XHJcblx0Ly8gRmV0Y2ggYWxsIHJlc3RhdXJhbnRzICB3aXRoIHByb3BlciBlcnJvciBoYW5kbGluZ1xyXG5cdElEYk9wZXJhdGlvbnNIZWxwZXIuZ2V0UmVzdGF1cmFudHNEYXRhKChlcnJvciwgcmVzdGF1cmFudHMpID0+IHtcclxuXHRcdGlmIChlcnJvcikge1xyXG5cdFx0XHRjYWxsYmFjayhlcnJvciwgbnVsbCk7XHJcblx0XHR9IGVsc2Uge1xyXG5cdFx0Ly8gRmlsdGVyIHJlc3RhdXJhbnRzIHRvIGhhdmUgb25seSBnaXZlbiBjdWlzaW5lIHR5cGVcclxuXHRcdGNvbnN0IHJlc3VsdHMgPSByZXN0YXVyYW50cy5maWx0ZXIociA9PiByLmN1aXNpbmVfdHlwZSA9PSBjdWlzaW5lKTtcclxuXHRcdGNhbGxiYWNrKG51bGwsIHJlc3VsdHMpO1xyXG5cdH1cclxufSk7XHJcbn1cclxuXHJcbiAgLyoqXHJcbiAgICogRmV0Y2ggcmVzdGF1cmFudHMgYnkgYSBuZWlnaGJvcmhvb2Qgd2l0aCBwcm9wZXIgZXJyb3IgaGFuZGxpbmcuXHJcbiAgICovXHJcbiAgIHN0YXRpYyBmZXRjaFJlc3RhdXJhbnRCeU5laWdoYm9yaG9vZChuZWlnaGJvcmhvb2QsIGNhbGxiYWNrKSB7XHJcblx0Ly8gRmV0Y2ggYWxsIHJlc3RhdXJhbnRzXHJcblx0SURiT3BlcmF0aW9uc0hlbHBlci5nZXRSZXN0YXVyYW50c0RhdGEoKGVycm9yLCByZXN0YXVyYW50cykgPT4ge1xyXG5cdFx0aWYgKGVycm9yKSB7XHJcblx0XHRcdGNhbGxiYWNrKGVycm9yLCBudWxsKTtcclxuXHRcdH0gZWxzZSB7XHJcblx0XHQvLyBGaWx0ZXIgcmVzdGF1cmFudHMgdG8gaGF2ZSBvbmx5IGdpdmVuIG5laWdoYm9yaG9vZFxyXG5cdFx0Y29uc3QgcmVzdWx0cyA9IHJlc3RhdXJhbnRzLmZpbHRlcihyID0+IHIubmVpZ2hib3Job29kID09IG5laWdoYm9yaG9vZCk7XHJcblx0XHRjYWxsYmFjayhudWxsLCByZXN1bHRzKTtcclxuXHR9XHJcbn0pO1xyXG59XHJcblxyXG4gIC8qKlxyXG4gICAqIEZldGNoIHJlc3RhdXJhbnRzIGJ5IGEgY3Vpc2luZSBhbmQgYSBuZWlnaGJvcmhvb2Qgd2l0aCBwcm9wZXIgZXJyb3IgaGFuZGxpbmcuXHJcbiAgICovXHJcbiAgIHN0YXRpYyBmZXRjaFJlc3RhdXJhbnRCeUN1aXNpbmVBbmROZWlnaGJvcmhvb2QoXHJcbiAgIFx0Y3Vpc2luZSxcclxuICAgXHRuZWlnaGJvcmhvb2QsXHJcbiAgIFx0Y2FsbGJhY2tcclxuICAgXHQpIHtcclxuXHQvLyBGZXRjaCBhbGwgcmVzdGF1cmFudHNcclxuXHRJRGJPcGVyYXRpb25zSGVscGVyLmdldFJlc3RhdXJhbnRzRGF0YSgoZXJyb3IsIHJlc3RhdXJhbnRzKSA9PiB7XHJcblx0XHRpZiAoZXJyb3IpIHtcclxuXHRcdFx0Y2FsbGJhY2soZXJyb3IsIG51bGwpO1xyXG5cdFx0fSBlbHNlIHtcclxuXHRcdFx0bGV0IHJlc3VsdHMgPSByZXN0YXVyYW50cztcclxuXHRcdFx0aWYgKGN1aXNpbmUgIT0gJ2FsbCcpIHtcclxuXHRcdCAgLy8gZmlsdGVyIGJ5IGN1aXNpbmVcclxuXHRcdCAgcmVzdWx0cyA9IHJlc3VsdHMuZmlsdGVyKHIgPT4gci5jdWlzaW5lX3R5cGUgPT0gY3Vpc2luZSk7XHJcblx0XHR9XHJcblx0XHRpZiAobmVpZ2hib3Job29kICE9ICdhbGwnKSB7XHJcblx0XHQgIC8vIGZpbHRlciBieSBuZWlnaGJvcmhvb2RcclxuXHRcdCAgcmVzdWx0cyA9IHJlc3VsdHMuZmlsdGVyKHIgPT4gci5uZWlnaGJvcmhvb2QgPT0gbmVpZ2hib3Job29kKTtcclxuXHRcdH1cclxuXHRcdGNhbGxiYWNrKG51bGwsIHJlc3VsdHMpO1xyXG5cdH1cclxufSk7XHJcbn1cclxuXHJcbiAgLyoqXHJcbiAgICogRmV0Y2ggYWxsIG5laWdoYm9yaG9vZHMgd2l0aCBwcm9wZXIgZXJyb3IgaGFuZGxpbmcuXHJcbiAgICovXHJcbiAgIHN0YXRpYyBmZXRjaE5laWdoYm9yaG9vZHMoY2FsbGJhY2spIHtcclxuXHQvLyBGZXRjaCBhbGwgcmVzdGF1cmFudHNcclxuXHRJRGJPcGVyYXRpb25zSGVscGVyLmdldFJlc3RhdXJhbnRzRGF0YSgoZXJyb3IsIHJlc3RhdXJhbnRzKSA9PiB7XHJcblx0XHRpZiAoZXJyb3IpIHtcclxuXHRcdFx0Y2FsbGJhY2soZXJyb3IsIG51bGwpO1xyXG5cdFx0fSBlbHNlIHtcclxuXHRcdC8vIEdldCBhbGwgbmVpZ2hib3Job29kcyBmcm9tIGFsbCByZXN0YXVyYW50c1xyXG5cdFx0Y29uc3QgbmVpZ2hib3Job29kcyA9IHJlc3RhdXJhbnRzLm1hcChcclxuXHRcdFx0KHYsIGkpID0+IHJlc3RhdXJhbnRzW2ldLm5laWdoYm9yaG9vZFxyXG5cdFx0XHQpO1xyXG5cdFx0Ly8gUmVtb3ZlIGR1cGxpY2F0ZXMgZnJvbSBuZWlnaGJvcmhvb2RzXHJcblx0XHRjb25zdCB1bmlxdWVOZWlnaGJvcmhvb2RzID0gbmVpZ2hib3Job29kcy5maWx0ZXIoXHJcblx0XHRcdCh2LCBpKSA9PiBuZWlnaGJvcmhvb2RzLmluZGV4T2YodikgPT0gaVxyXG5cdFx0XHQpO1xyXG5cdFx0Y2FsbGJhY2sobnVsbCwgdW5pcXVlTmVpZ2hib3Job29kcyk7XHJcblx0fVxyXG59KTtcclxufVxyXG5cclxuICAvKipcclxuICAgKiBGZXRjaCBhbGwgY3Vpc2luZXMgd2l0aCBwcm9wZXIgZXJyb3IgaGFuZGxpbmcuXHJcbiAgICovXHJcbiAgIHN0YXRpYyBmZXRjaEN1aXNpbmVzKGNhbGxiYWNrKSB7XHJcblx0Ly8gRmV0Y2ggYWxsIHJlc3RhdXJhbnRzXHJcblx0SURiT3BlcmF0aW9uc0hlbHBlci5nZXRSZXN0YXVyYW50c0RhdGEoKGVycm9yLCByZXN0YXVyYW50cykgPT4ge1xyXG5cdFx0aWYgKGVycm9yKSB7XHJcblx0XHRcdGNhbGxiYWNrKGVycm9yLCBudWxsKTtcclxuXHRcdH0gZWxzZSB7XHJcblx0XHQvLyBHZXQgYWxsIGN1aXNpbmVzIGZyb20gYWxsIHJlc3RhdXJhbnRzXHJcblx0XHRjb25zdCBjdWlzaW5lcyA9IHJlc3RhdXJhbnRzLm1hcCgodiwgaSkgPT4gcmVzdGF1cmFudHNbaV0uY3Vpc2luZV90eXBlKTtcclxuXHRcdC8vIFJlbW92ZSBkdXBsaWNhdGVzIGZyb20gY3Vpc2luZXNcclxuXHRcdGNvbnN0IHVuaXF1ZUN1aXNpbmVzID0gY3Vpc2luZXMuZmlsdGVyKFxyXG5cdFx0XHQodiwgaSkgPT4gY3Vpc2luZXMuaW5kZXhPZih2KSA9PSBpXHJcblx0XHRcdCk7XHJcblx0XHRjYWxsYmFjayhudWxsLCB1bmlxdWVDdWlzaW5lcyk7XHJcblx0fVxyXG59KTtcclxufVxyXG5cclxuICAvKipcclxuICAgKiBSZXN0YXVyYW50IHBhZ2UgVVJMLlxyXG4gICAqL1xyXG4gICBzdGF0aWMgdXJsRm9yUmVzdGF1cmFudChyZXN0YXVyYW50KSB7XHJcbiAgIFx0cmV0dXJuIGAuL3Jlc3RhdXJhbnQuaHRtbD9pZD0ke3Jlc3RhdXJhbnQuaWR9YDtcclxuICAgfVxyXG5cclxuICAvKipcclxuICAgKiBSZXN0YXVyYW50IGltYWdlIFVSTC5cclxuICAgKi9cclxuICAgc3RhdGljIGltYWdlVXJsRm9yUmVzdGF1cmFudChyZXN0YXVyYW50KSB7XHJcbiAgIFx0cmV0dXJuIGAvaW1nLyR7cmVzdGF1cmFudC5waG90b2dyYXBofWA7XHJcbiAgIH1cclxuXHJcbiAgLyoqXHJcbiAgICogTWFwIG1hcmtlciBmb3IgYSByZXN0YXVyYW50LlxyXG4gICAqL1xyXG4gICBzdGF0aWMgbWFwTWFya2VyRm9yUmVzdGF1cmFudChyZXN0YXVyYW50LCBtYXApIHtcclxuICAgXHRjb25zdCBtYXJrZXIgPSBuZXcgTC5tYXJrZXIoXHJcbiAgIFx0XHRbcmVzdGF1cmFudC5sYXRsbmcubGF0LCByZXN0YXVyYW50LmxhdGxuZy5sbmddLFxyXG4gICBcdFx0e1xyXG4gICBcdFx0XHR0aXRsZTogcmVzdGF1cmFudC5uYW1lLFxyXG4gICBcdFx0XHRhbHQ6IHJlc3RhdXJhbnQubmFtZSxcclxuICAgXHRcdFx0dXJsOiBEQkhlbHBlci51cmxGb3JSZXN0YXVyYW50KHJlc3RhdXJhbnQpXHJcbiAgIFx0XHR9XHJcbiAgIFx0XHQpO1xyXG4gICBcdG1hcmtlci5hZGRUbyhuZXdNYXApO1xyXG4gICBcdHJldHVybiBtYXJrZXI7XHJcbiAgIH1cclxufSIsIid1c2Ugc3RyaWN0JztcblxuKGZ1bmN0aW9uKCkge1xuICBmdW5jdGlvbiB0b0FycmF5KGFycikge1xuICAgIHJldHVybiBBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChhcnIpO1xuICB9XG5cbiAgZnVuY3Rpb24gcHJvbWlzaWZ5UmVxdWVzdChyZXF1ZXN0KSB7XG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uKHJlc29sdmUsIHJlamVjdCkge1xuICAgICAgcmVxdWVzdC5vbnN1Y2Nlc3MgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgcmVzb2x2ZShyZXF1ZXN0LnJlc3VsdCk7XG4gICAgICB9O1xuXG4gICAgICByZXF1ZXN0Lm9uZXJyb3IgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgcmVqZWN0KHJlcXVlc3QuZXJyb3IpO1xuICAgICAgfTtcbiAgICB9KTtcbiAgfVxuXG4gIGZ1bmN0aW9uIHByb21pc2lmeVJlcXVlc3RDYWxsKG9iaiwgbWV0aG9kLCBhcmdzKSB7XG4gICAgdmFyIHJlcXVlc3Q7XG4gICAgdmFyIHAgPSBuZXcgUHJvbWlzZShmdW5jdGlvbihyZXNvbHZlLCByZWplY3QpIHtcbiAgICAgIHJlcXVlc3QgPSBvYmpbbWV0aG9kXS5hcHBseShvYmosIGFyZ3MpO1xuICAgICAgcHJvbWlzaWZ5UmVxdWVzdChyZXF1ZXN0KS50aGVuKHJlc29sdmUsIHJlamVjdCk7XG4gICAgfSk7XG5cbiAgICBwLnJlcXVlc3QgPSByZXF1ZXN0O1xuICAgIHJldHVybiBwO1xuICB9XG5cbiAgZnVuY3Rpb24gcHJvbWlzaWZ5Q3Vyc29yUmVxdWVzdENhbGwob2JqLCBtZXRob2QsIGFyZ3MpIHtcbiAgICB2YXIgcCA9IHByb21pc2lmeVJlcXVlc3RDYWxsKG9iaiwgbWV0aG9kLCBhcmdzKTtcbiAgICByZXR1cm4gcC50aGVuKGZ1bmN0aW9uKHZhbHVlKSB7XG4gICAgICBpZiAoIXZhbHVlKSByZXR1cm47XG4gICAgICByZXR1cm4gbmV3IEN1cnNvcih2YWx1ZSwgcC5yZXF1ZXN0KTtcbiAgICB9KTtcbiAgfVxuXG4gIGZ1bmN0aW9uIHByb3h5UHJvcGVydGllcyhQcm94eUNsYXNzLCB0YXJnZXRQcm9wLCBwcm9wZXJ0aWVzKSB7XG4gICAgcHJvcGVydGllcy5mb3JFYWNoKGZ1bmN0aW9uKHByb3ApIHtcbiAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShQcm94eUNsYXNzLnByb3RvdHlwZSwgcHJvcCwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgIHJldHVybiB0aGlzW3RhcmdldFByb3BdW3Byb3BdO1xuICAgICAgICB9LFxuICAgICAgICBzZXQ6IGZ1bmN0aW9uKHZhbCkge1xuICAgICAgICAgIHRoaXNbdGFyZ2V0UHJvcF1bcHJvcF0gPSB2YWw7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgIH0pO1xuICB9XG5cbiAgZnVuY3Rpb24gcHJveHlSZXF1ZXN0TWV0aG9kcyhQcm94eUNsYXNzLCB0YXJnZXRQcm9wLCBDb25zdHJ1Y3RvciwgcHJvcGVydGllcykge1xuICAgIHByb3BlcnRpZXMuZm9yRWFjaChmdW5jdGlvbihwcm9wKSB7XG4gICAgICBpZiAoIShwcm9wIGluIENvbnN0cnVjdG9yLnByb3RvdHlwZSkpIHJldHVybjtcbiAgICAgIFByb3h5Q2xhc3MucHJvdG90eXBlW3Byb3BdID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiBwcm9taXNpZnlSZXF1ZXN0Q2FsbCh0aGlzW3RhcmdldFByb3BdLCBwcm9wLCBhcmd1bWVudHMpO1xuICAgICAgfTtcbiAgICB9KTtcbiAgfVxuXG4gIGZ1bmN0aW9uIHByb3h5TWV0aG9kcyhQcm94eUNsYXNzLCB0YXJnZXRQcm9wLCBDb25zdHJ1Y3RvciwgcHJvcGVydGllcykge1xuICAgIHByb3BlcnRpZXMuZm9yRWFjaChmdW5jdGlvbihwcm9wKSB7XG4gICAgICBpZiAoIShwcm9wIGluIENvbnN0cnVjdG9yLnByb3RvdHlwZSkpIHJldHVybjtcbiAgICAgIFByb3h5Q2xhc3MucHJvdG90eXBlW3Byb3BdID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiB0aGlzW3RhcmdldFByb3BdW3Byb3BdLmFwcGx5KHRoaXNbdGFyZ2V0UHJvcF0sIGFyZ3VtZW50cyk7XG4gICAgICB9O1xuICAgIH0pO1xuICB9XG5cbiAgZnVuY3Rpb24gcHJveHlDdXJzb3JSZXF1ZXN0TWV0aG9kcyhQcm94eUNsYXNzLCB0YXJnZXRQcm9wLCBDb25zdHJ1Y3RvciwgcHJvcGVydGllcykge1xuICAgIHByb3BlcnRpZXMuZm9yRWFjaChmdW5jdGlvbihwcm9wKSB7XG4gICAgICBpZiAoIShwcm9wIGluIENvbnN0cnVjdG9yLnByb3RvdHlwZSkpIHJldHVybjtcbiAgICAgIFByb3h5Q2xhc3MucHJvdG90eXBlW3Byb3BdID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiBwcm9taXNpZnlDdXJzb3JSZXF1ZXN0Q2FsbCh0aGlzW3RhcmdldFByb3BdLCBwcm9wLCBhcmd1bWVudHMpO1xuICAgICAgfTtcbiAgICB9KTtcbiAgfVxuXG4gIGZ1bmN0aW9uIEluZGV4KGluZGV4KSB7XG4gICAgdGhpcy5faW5kZXggPSBpbmRleDtcbiAgfVxuXG4gIHByb3h5UHJvcGVydGllcyhJbmRleCwgJ19pbmRleCcsIFtcbiAgICAnbmFtZScsXG4gICAgJ2tleVBhdGgnLFxuICAgICdtdWx0aUVudHJ5JyxcbiAgICAndW5pcXVlJ1xuICBdKTtcblxuICBwcm94eVJlcXVlc3RNZXRob2RzKEluZGV4LCAnX2luZGV4JywgSURCSW5kZXgsIFtcbiAgICAnZ2V0JyxcbiAgICAnZ2V0S2V5JyxcbiAgICAnZ2V0QWxsJyxcbiAgICAnZ2V0QWxsS2V5cycsXG4gICAgJ2NvdW50J1xuICBdKTtcblxuICBwcm94eUN1cnNvclJlcXVlc3RNZXRob2RzKEluZGV4LCAnX2luZGV4JywgSURCSW5kZXgsIFtcbiAgICAnb3BlbkN1cnNvcicsXG4gICAgJ29wZW5LZXlDdXJzb3InXG4gIF0pO1xuXG4gIGZ1bmN0aW9uIEN1cnNvcihjdXJzb3IsIHJlcXVlc3QpIHtcbiAgICB0aGlzLl9jdXJzb3IgPSBjdXJzb3I7XG4gICAgdGhpcy5fcmVxdWVzdCA9IHJlcXVlc3Q7XG4gIH1cblxuICBwcm94eVByb3BlcnRpZXMoQ3Vyc29yLCAnX2N1cnNvcicsIFtcbiAgICAnZGlyZWN0aW9uJyxcbiAgICAna2V5JyxcbiAgICAncHJpbWFyeUtleScsXG4gICAgJ3ZhbHVlJ1xuICBdKTtcblxuICBwcm94eVJlcXVlc3RNZXRob2RzKEN1cnNvciwgJ19jdXJzb3InLCBJREJDdXJzb3IsIFtcbiAgICAndXBkYXRlJyxcbiAgICAnZGVsZXRlJ1xuICBdKTtcblxuICAvLyBwcm94eSAnbmV4dCcgbWV0aG9kc1xuICBbJ2FkdmFuY2UnLCAnY29udGludWUnLCAnY29udGludWVQcmltYXJ5S2V5J10uZm9yRWFjaChmdW5jdGlvbihtZXRob2ROYW1lKSB7XG4gICAgaWYgKCEobWV0aG9kTmFtZSBpbiBJREJDdXJzb3IucHJvdG90eXBlKSkgcmV0dXJuO1xuICAgIEN1cnNvci5wcm90b3R5cGVbbWV0aG9kTmFtZV0gPSBmdW5jdGlvbigpIHtcbiAgICAgIHZhciBjdXJzb3IgPSB0aGlzO1xuICAgICAgdmFyIGFyZ3MgPSBhcmd1bWVudHM7XG4gICAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKCkudGhlbihmdW5jdGlvbigpIHtcbiAgICAgICAgY3Vyc29yLl9jdXJzb3JbbWV0aG9kTmFtZV0uYXBwbHkoY3Vyc29yLl9jdXJzb3IsIGFyZ3MpO1xuICAgICAgICByZXR1cm4gcHJvbWlzaWZ5UmVxdWVzdChjdXJzb3IuX3JlcXVlc3QpLnRoZW4oZnVuY3Rpb24odmFsdWUpIHtcbiAgICAgICAgICBpZiAoIXZhbHVlKSByZXR1cm47XG4gICAgICAgICAgcmV0dXJuIG5ldyBDdXJzb3IodmFsdWUsIGN1cnNvci5fcmVxdWVzdCk7XG4gICAgICAgIH0pO1xuICAgICAgfSk7XG4gICAgfTtcbiAgfSk7XG5cbiAgZnVuY3Rpb24gT2JqZWN0U3RvcmUoc3RvcmUpIHtcbiAgICB0aGlzLl9zdG9yZSA9IHN0b3JlO1xuICB9XG5cbiAgT2JqZWN0U3RvcmUucHJvdG90eXBlLmNyZWF0ZUluZGV4ID0gZnVuY3Rpb24oKSB7XG4gICAgcmV0dXJuIG5ldyBJbmRleCh0aGlzLl9zdG9yZS5jcmVhdGVJbmRleC5hcHBseSh0aGlzLl9zdG9yZSwgYXJndW1lbnRzKSk7XG4gIH07XG5cbiAgT2JqZWN0U3RvcmUucHJvdG90eXBlLmluZGV4ID0gZnVuY3Rpb24oKSB7XG4gICAgcmV0dXJuIG5ldyBJbmRleCh0aGlzLl9zdG9yZS5pbmRleC5hcHBseSh0aGlzLl9zdG9yZSwgYXJndW1lbnRzKSk7XG4gIH07XG5cbiAgcHJveHlQcm9wZXJ0aWVzKE9iamVjdFN0b3JlLCAnX3N0b3JlJywgW1xuICAgICduYW1lJyxcbiAgICAna2V5UGF0aCcsXG4gICAgJ2luZGV4TmFtZXMnLFxuICAgICdhdXRvSW5jcmVtZW50J1xuICBdKTtcblxuICBwcm94eVJlcXVlc3RNZXRob2RzKE9iamVjdFN0b3JlLCAnX3N0b3JlJywgSURCT2JqZWN0U3RvcmUsIFtcbiAgICAncHV0JyxcbiAgICAnYWRkJyxcbiAgICAnZGVsZXRlJyxcbiAgICAnY2xlYXInLFxuICAgICdnZXQnLFxuICAgICdnZXRBbGwnLFxuICAgICdnZXRLZXknLFxuICAgICdnZXRBbGxLZXlzJyxcbiAgICAnY291bnQnXG4gIF0pO1xuXG4gIHByb3h5Q3Vyc29yUmVxdWVzdE1ldGhvZHMoT2JqZWN0U3RvcmUsICdfc3RvcmUnLCBJREJPYmplY3RTdG9yZSwgW1xuICAgICdvcGVuQ3Vyc29yJyxcbiAgICAnb3BlbktleUN1cnNvcidcbiAgXSk7XG5cbiAgcHJveHlNZXRob2RzKE9iamVjdFN0b3JlLCAnX3N0b3JlJywgSURCT2JqZWN0U3RvcmUsIFtcbiAgICAnZGVsZXRlSW5kZXgnXG4gIF0pO1xuXG4gIGZ1bmN0aW9uIFRyYW5zYWN0aW9uKGlkYlRyYW5zYWN0aW9uKSB7XG4gICAgdGhpcy5fdHggPSBpZGJUcmFuc2FjdGlvbjtcbiAgICB0aGlzLmNvbXBsZXRlID0gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSwgcmVqZWN0KSB7XG4gICAgICBpZGJUcmFuc2FjdGlvbi5vbmNvbXBsZXRlID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHJlc29sdmUoKTtcbiAgICAgIH07XG4gICAgICBpZGJUcmFuc2FjdGlvbi5vbmVycm9yID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHJlamVjdChpZGJUcmFuc2FjdGlvbi5lcnJvcik7XG4gICAgICB9O1xuICAgICAgaWRiVHJhbnNhY3Rpb24ub25hYm9ydCA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZWplY3QoaWRiVHJhbnNhY3Rpb24uZXJyb3IpO1xuICAgICAgfTtcbiAgICB9KTtcbiAgfVxuXG4gIFRyYW5zYWN0aW9uLnByb3RvdHlwZS5vYmplY3RTdG9yZSA9IGZ1bmN0aW9uKCkge1xuICAgIHJldHVybiBuZXcgT2JqZWN0U3RvcmUodGhpcy5fdHgub2JqZWN0U3RvcmUuYXBwbHkodGhpcy5fdHgsIGFyZ3VtZW50cykpO1xuICB9O1xuXG4gIHByb3h5UHJvcGVydGllcyhUcmFuc2FjdGlvbiwgJ190eCcsIFtcbiAgICAnb2JqZWN0U3RvcmVOYW1lcycsXG4gICAgJ21vZGUnXG4gIF0pO1xuXG4gIHByb3h5TWV0aG9kcyhUcmFuc2FjdGlvbiwgJ190eCcsIElEQlRyYW5zYWN0aW9uLCBbXG4gICAgJ2Fib3J0J1xuICBdKTtcblxuICBmdW5jdGlvbiBVcGdyYWRlREIoZGIsIG9sZFZlcnNpb24sIHRyYW5zYWN0aW9uKSB7XG4gICAgdGhpcy5fZGIgPSBkYjtcbiAgICB0aGlzLm9sZFZlcnNpb24gPSBvbGRWZXJzaW9uO1xuICAgIHRoaXMudHJhbnNhY3Rpb24gPSBuZXcgVHJhbnNhY3Rpb24odHJhbnNhY3Rpb24pO1xuICB9XG5cbiAgVXBncmFkZURCLnByb3RvdHlwZS5jcmVhdGVPYmplY3RTdG9yZSA9IGZ1bmN0aW9uKCkge1xuICAgIHJldHVybiBuZXcgT2JqZWN0U3RvcmUodGhpcy5fZGIuY3JlYXRlT2JqZWN0U3RvcmUuYXBwbHkodGhpcy5fZGIsIGFyZ3VtZW50cykpO1xuICB9O1xuXG4gIHByb3h5UHJvcGVydGllcyhVcGdyYWRlREIsICdfZGInLCBbXG4gICAgJ25hbWUnLFxuICAgICd2ZXJzaW9uJyxcbiAgICAnb2JqZWN0U3RvcmVOYW1lcydcbiAgXSk7XG5cbiAgcHJveHlNZXRob2RzKFVwZ3JhZGVEQiwgJ19kYicsIElEQkRhdGFiYXNlLCBbXG4gICAgJ2RlbGV0ZU9iamVjdFN0b3JlJyxcbiAgICAnY2xvc2UnXG4gIF0pO1xuXG4gIGZ1bmN0aW9uIERCKGRiKSB7XG4gICAgdGhpcy5fZGIgPSBkYjtcbiAgfVxuXG4gIERCLnByb3RvdHlwZS50cmFuc2FjdGlvbiA9IGZ1bmN0aW9uKCkge1xuICAgIHJldHVybiBuZXcgVHJhbnNhY3Rpb24odGhpcy5fZGIudHJhbnNhY3Rpb24uYXBwbHkodGhpcy5fZGIsIGFyZ3VtZW50cykpO1xuICB9O1xuXG4gIHByb3h5UHJvcGVydGllcyhEQiwgJ19kYicsIFtcbiAgICAnbmFtZScsXG4gICAgJ3ZlcnNpb24nLFxuICAgICdvYmplY3RTdG9yZU5hbWVzJ1xuICBdKTtcblxuICBwcm94eU1ldGhvZHMoREIsICdfZGInLCBJREJEYXRhYmFzZSwgW1xuICAgICdjbG9zZSdcbiAgXSk7XG5cbiAgLy8gQWRkIGN1cnNvciBpdGVyYXRvcnNcbiAgLy8gVE9ETzogcmVtb3ZlIHRoaXMgb25jZSBicm93c2VycyBkbyB0aGUgcmlnaHQgdGhpbmcgd2l0aCBwcm9taXNlc1xuICBbJ29wZW5DdXJzb3InLCAnb3BlbktleUN1cnNvciddLmZvckVhY2goZnVuY3Rpb24oZnVuY05hbWUpIHtcbiAgICBbT2JqZWN0U3RvcmUsIEluZGV4XS5mb3JFYWNoKGZ1bmN0aW9uKENvbnN0cnVjdG9yKSB7XG4gICAgICAvLyBEb24ndCBjcmVhdGUgaXRlcmF0ZUtleUN1cnNvciBpZiBvcGVuS2V5Q3Vyc29yIGRvZXNuJ3QgZXhpc3QuXG4gICAgICBpZiAoIShmdW5jTmFtZSBpbiBDb25zdHJ1Y3Rvci5wcm90b3R5cGUpKSByZXR1cm47XG5cbiAgICAgIENvbnN0cnVjdG9yLnByb3RvdHlwZVtmdW5jTmFtZS5yZXBsYWNlKCdvcGVuJywgJ2l0ZXJhdGUnKV0gPSBmdW5jdGlvbigpIHtcbiAgICAgICAgdmFyIGFyZ3MgPSB0b0FycmF5KGFyZ3VtZW50cyk7XG4gICAgICAgIHZhciBjYWxsYmFjayA9IGFyZ3NbYXJncy5sZW5ndGggLSAxXTtcbiAgICAgICAgdmFyIG5hdGl2ZU9iamVjdCA9IHRoaXMuX3N0b3JlIHx8IHRoaXMuX2luZGV4O1xuICAgICAgICB2YXIgcmVxdWVzdCA9IG5hdGl2ZU9iamVjdFtmdW5jTmFtZV0uYXBwbHkobmF0aXZlT2JqZWN0LCBhcmdzLnNsaWNlKDAsIC0xKSk7XG4gICAgICAgIHJlcXVlc3Qub25zdWNjZXNzID0gZnVuY3Rpb24oKSB7XG4gICAgICAgICAgY2FsbGJhY2socmVxdWVzdC5yZXN1bHQpO1xuICAgICAgICB9O1xuICAgICAgfTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgLy8gcG9seWZpbGwgZ2V0QWxsXG4gIFtJbmRleCwgT2JqZWN0U3RvcmVdLmZvckVhY2goZnVuY3Rpb24oQ29uc3RydWN0b3IpIHtcbiAgICBpZiAoQ29uc3RydWN0b3IucHJvdG90eXBlLmdldEFsbCkgcmV0dXJuO1xuICAgIENvbnN0cnVjdG9yLnByb3RvdHlwZS5nZXRBbGwgPSBmdW5jdGlvbihxdWVyeSwgY291bnQpIHtcbiAgICAgIHZhciBpbnN0YW5jZSA9IHRoaXM7XG4gICAgICB2YXIgaXRlbXMgPSBbXTtcblxuICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uKHJlc29sdmUpIHtcbiAgICAgICAgaW5zdGFuY2UuaXRlcmF0ZUN1cnNvcihxdWVyeSwgZnVuY3Rpb24oY3Vyc29yKSB7XG4gICAgICAgICAgaWYgKCFjdXJzb3IpIHtcbiAgICAgICAgICAgIHJlc29sdmUoaXRlbXMpO1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgIH1cbiAgICAgICAgICBpdGVtcy5wdXNoKGN1cnNvci52YWx1ZSk7XG5cbiAgICAgICAgICBpZiAoY291bnQgIT09IHVuZGVmaW5lZCAmJiBpdGVtcy5sZW5ndGggPT0gY291bnQpIHtcbiAgICAgICAgICAgIHJlc29sdmUoaXRlbXMpO1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgIH1cbiAgICAgICAgICBjdXJzb3IuY29udGludWUoKTtcbiAgICAgICAgfSk7XG4gICAgICB9KTtcbiAgICB9O1xuICB9KTtcblxuICB2YXIgZXhwID0ge1xuICAgIG9wZW46IGZ1bmN0aW9uKG5hbWUsIHZlcnNpb24sIHVwZ3JhZGVDYWxsYmFjaykge1xuICAgICAgdmFyIHAgPSBwcm9taXNpZnlSZXF1ZXN0Q2FsbChpbmRleGVkREIsICdvcGVuJywgW25hbWUsIHZlcnNpb25dKTtcbiAgICAgIHZhciByZXF1ZXN0ID0gcC5yZXF1ZXN0O1xuXG4gICAgICBpZiAocmVxdWVzdCkge1xuICAgICAgICByZXF1ZXN0Lm9udXBncmFkZW5lZWRlZCA9IGZ1bmN0aW9uKGV2ZW50KSB7XG4gICAgICAgICAgaWYgKHVwZ3JhZGVDYWxsYmFjaykge1xuICAgICAgICAgICAgdXBncmFkZUNhbGxiYWNrKG5ldyBVcGdyYWRlREIocmVxdWVzdC5yZXN1bHQsIGV2ZW50Lm9sZFZlcnNpb24sIHJlcXVlc3QudHJhbnNhY3Rpb24pKTtcbiAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgICB9XG5cbiAgICAgIHJldHVybiBwLnRoZW4oZnVuY3Rpb24oZGIpIHtcbiAgICAgICAgcmV0dXJuIG5ldyBEQihkYik7XG4gICAgICB9KTtcbiAgICB9LFxuICAgIGRlbGV0ZTogZnVuY3Rpb24obmFtZSkge1xuICAgICAgcmV0dXJuIHByb21pc2lmeVJlcXVlc3RDYWxsKGluZGV4ZWREQiwgJ2RlbGV0ZURhdGFiYXNlJywgW25hbWVdKTtcbiAgICB9XG4gIH07XG5cbiAgaWYgKHR5cGVvZiBtb2R1bGUgIT09ICd1bmRlZmluZWQnKSB7XG4gICAgbW9kdWxlLmV4cG9ydHMgPSBleHA7XG4gICAgbW9kdWxlLmV4cG9ydHMuZGVmYXVsdCA9IG1vZHVsZS5leHBvcnRzO1xuICB9XG4gIGVsc2Uge1xuICAgIHNlbGYuaWRiID0gZXhwO1xuICB9XG59KCkpO1xuIiwiaWYgKG5hdmlnYXRvci5zZXJ2aWNlV29ya2VyKSB7XG4gICAgbmF2aWdhdG9yLnNlcnZpY2VXb3JrZXIucmVnaXN0ZXIoJy9zdy5qcycpLnRoZW4oZnVuY3Rpb24ocmVnKSB7XG4gICAgICAgIGNvbnNvbGUubG9nKCdXb3JrZXIgcmVnaXN0ZXJlZCEnKTtcbiAgICB9KS5jYXRjaChmdW5jdGlvbihlcnIpIHtcbiAgICAgICAgY29uc29sZS5sb2coZXJyKTtcbiAgICB9KTtcblxufSIsImxldCByZXN0YXVyYW50cyxcclxuICAgIG5laWdoYm9yaG9vZHMsXHJcbiAgICBjdWlzaW5lc1xyXG52YXIgbmV3TWFwXHJcbnZhciBtYXJrZXJzID0gW11cclxuXHJcbi8qKlxyXG4gKiBGZXRjaCBuZWlnaGJvcmhvb2RzIGFuZCBjdWlzaW5lcyBhcyBzb29uIGFzIHRoZSBwYWdlIGlzIGxvYWRlZC5cclxuICovXHJcbmRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ0RPTUNvbnRlbnRMb2FkZWQnLCAoZXZlbnQpID0+IHtcclxuICAgIGluaXRNYXAoKTsgLy8gYWRkZWRcclxuICAgIGZldGNoTmVpZ2hib3Job29kcygpO1xyXG4gICAgZmV0Y2hDdWlzaW5lcygpO1xyXG59KTtcclxuXHJcbi8qKlxyXG4gKiBGZXRjaCBhbGwgbmVpZ2hib3Job29kcyBhbmQgc2V0IHRoZWlyIEhUTUwuXHJcbiAqL1xyXG5mZXRjaE5laWdoYm9yaG9vZHMgPSAoKSA9PiB7XHJcbiAgICBEQkhlbHBlci5mZXRjaE5laWdoYm9yaG9vZHMoKGVycm9yLCBuZWlnaGJvcmhvb2RzKSA9PiB7XHJcbiAgICAgICAgaWYgKGVycm9yKSB7IC8vIEdvdCBhbiBlcnJvclxyXG4gICAgICAgICAgICBjb25zb2xlLmVycm9yKGVycm9yKTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICBzZWxmLm5laWdoYm9yaG9vZHMgPSBuZWlnaGJvcmhvb2RzO1xyXG4gICAgICAgICAgICBmaWxsTmVpZ2hib3Job29kc0hUTUwoKTtcclxuICAgICAgICB9XHJcbiAgICB9KTtcclxufVxyXG5cclxuLyoqXHJcbiAqIFNldCBuZWlnaGJvcmhvb2RzIEhUTUwuXHJcbiAqL1xyXG5maWxsTmVpZ2hib3Job29kc0hUTUwgPSAobmVpZ2hib3Job29kcyA9IHNlbGYubmVpZ2hib3Job29kcykgPT4ge1xyXG4gICAgY29uc3Qgc2VsZWN0ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ25laWdoYm9yaG9vZHMtc2VsZWN0Jyk7XHJcbiAgICBuZWlnaGJvcmhvb2RzLmZvckVhY2gobmVpZ2hib3Job29kID0+IHtcclxuICAgICAgICBjb25zdCBvcHRpb24gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdvcHRpb24nKTtcclxuICAgICAgICBvcHRpb24uaW5uZXJIVE1MID0gbmVpZ2hib3Job29kO1xyXG4gICAgICAgIG9wdGlvbi52YWx1ZSA9IG5laWdoYm9yaG9vZDtcclxuICAgICAgICBzZWxlY3QuYXBwZW5kKG9wdGlvbik7XHJcbiAgICB9KTtcclxufVxyXG5cclxuLyoqXHJcbiAqIEZldGNoIGFsbCBjdWlzaW5lcyBhbmQgc2V0IHRoZWlyIEhUTUwuXHJcbiAqL1xyXG5mZXRjaEN1aXNpbmVzID0gKCkgPT4ge1xyXG4gICAgREJIZWxwZXIuZmV0Y2hDdWlzaW5lcygoZXJyb3IsIGN1aXNpbmVzKSA9PiB7XHJcbiAgICAgICAgaWYgKGVycm9yKSB7IC8vIEdvdCBhbiBlcnJvciFcclxuICAgICAgICAgICAgY29uc29sZS5lcnJvcihlcnJvcik7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgc2VsZi5jdWlzaW5lcyA9IGN1aXNpbmVzO1xyXG4gICAgICAgICAgICBmaWxsQ3Vpc2luZXNIVE1MKCk7XHJcbiAgICAgICAgfVxyXG4gICAgfSk7XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBTZXQgY3Vpc2luZXMgSFRNTC5cclxuICovXHJcbmZpbGxDdWlzaW5lc0hUTUwgPSAoY3Vpc2luZXMgPSBzZWxmLmN1aXNpbmVzKSA9PiB7XHJcbiAgICBjb25zdCBzZWxlY3QgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnY3Vpc2luZXMtc2VsZWN0Jyk7XHJcblxyXG4gICAgY3Vpc2luZXMuZm9yRWFjaChjdWlzaW5lID0+IHtcclxuICAgICAgICBjb25zdCBvcHRpb24gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdvcHRpb24nKTtcclxuICAgICAgICBvcHRpb24uaW5uZXJIVE1MID0gY3Vpc2luZTtcclxuICAgICAgICBvcHRpb24udmFsdWUgPSBjdWlzaW5lO1xyXG4gICAgICAgIHNlbGVjdC5hcHBlbmQob3B0aW9uKTtcclxuICAgIH0pO1xyXG59XHJcblxyXG4vKipcclxuICogSW5pdGlhbGl6ZSBsZWFmbGV0IG1hcCwgY2FsbGVkIGZyb20gSFRNTC5cclxuICovXHJcbmluaXRNYXAgPSAoKSA9PiB7XHJcbiAgICBzZWxmLm5ld01hcCA9IEwubWFwKCdtYXAnLCB7XHJcbiAgICAgICAgY2VudGVyOiBbNDAuNzIyMjE2LCAtNzMuOTg3NTAxXSxcclxuICAgICAgICB6b29tOiAxMixcclxuICAgICAgICBzY3JvbGxXaGVlbFpvb206IGZhbHNlXHJcbiAgICB9KTtcclxuICAgIEwudGlsZUxheWVyKCdodHRwczovL2FwaS50aWxlcy5tYXBib3guY29tL3Y0L3tpZH0ve3p9L3t4fS97eX0uanBnNzA/YWNjZXNzX3Rva2VuPXttYXBib3hUb2tlbn0nLCB7XHJcbiAgICAgICAgbWFwYm94VG9rZW46ICdway5leUoxSWpvaWFXMTJjRzR5TWlJc0ltRWlPaUpqYW1sMmJubHljR0V4TTNGdU0zRnhiVGMwZVdNMk5IVjJJbjAuRVNzMzc0eE4zZ3VGQUdPXzFFUGRtUScsXHJcbiAgICAgICAgbWF4Wm9vbTogMTgsXHJcbiAgICAgICAgYXR0cmlidXRpb246ICdNYXAgZGF0YSAmY29weTsgPGEgaHJlZj1cImh0dHBzOi8vd3d3Lm9wZW5zdHJlZXRtYXAub3JnL1wiPk9wZW5TdHJlZXRNYXA8L2E+IGNvbnRyaWJ1dG9ycywgJyArXHJcbiAgICAgICAgJzxhIGhyZWY9XCJodHRwczovL2NyZWF0aXZlY29tbW9ucy5vcmcvbGljZW5zZXMvYnktc2EvMi4wL1wiPkNDLUJZLVNBPC9hPiwgJyArXHJcbiAgICAgICAgJ0ltYWdlcnkgwqkgPGEgaHJlZj1cImh0dHBzOi8vd3d3Lm1hcGJveC5jb20vXCI+TWFwYm94PC9hPicsXHJcbiAgICAgICAgaWQ6ICdtYXBib3guc3RyZWV0cydcclxuICAgIH0pLmFkZFRvKG5ld01hcCk7XHJcblxyXG4gICAgdXBkYXRlUmVzdGF1cmFudHMoKTtcclxufVxyXG4vKiB3aW5kb3cuaW5pdE1hcCA9ICgpID0+IHtcclxuICBsZXQgbG9jID0ge1xyXG4gICAgbGF0OiA0MC43MjIyMTYsXHJcbiAgICBsbmc6IC03My45ODc1MDFcclxuICB9O1xyXG4gIHNlbGYubWFwID0gbmV3IGdvb2dsZS5tYXBzLk1hcChkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbWFwJyksIHtcclxuICAgIHpvb206IDEyLFxyXG4gICAgY2VudGVyOiBsb2MsXHJcbiAgICBzY3JvbGx3aGVlbDogZmFsc2VcclxuICB9KTtcclxuICB1cGRhdGVSZXN0YXVyYW50cygpO1xyXG59ICovXHJcblxyXG4vKipcclxuICogVXBkYXRlIHBhZ2UgYW5kIG1hcCBmb3IgY3VycmVudCByZXN0YWxpc3R1cmFudHMuXHJcbiAqL1xyXG51cGRhdGVSZXN0YXVyYW50cyA9ICgpID0+IHtcclxuICAgIGNvbnN0IGNTZWxlY3QgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnY3Vpc2luZXMtc2VsZWN0Jyk7XHJcbiAgICBjb25zdCBuU2VsZWN0ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ25laWdoYm9yaG9vZHMtc2VsZWN0Jyk7XHJcblxyXG4gICAgY29uc3QgY0luZGV4ID0gY1NlbGVjdC5zZWxlY3RlZEluZGV4O1xyXG4gICAgY29uc3QgbkluZGV4ID0gblNlbGVjdC5zZWxlY3RlZEluZGV4O1xyXG5cclxuICAgIGNvbnN0IGN1aXNpbmUgPSBjU2VsZWN0W2NJbmRleF0udmFsdWU7XHJcbiAgICBjb25zdCBuZWlnaGJvcmhvb2QgPSBuU2VsZWN0W25JbmRleF0udmFsdWU7XHJcblxyXG4gICAgREJIZWxwZXIuZmV0Y2hSZXN0YXVyYW50QnlDdWlzaW5lQW5kTmVpZ2hib3Job29kKGN1aXNpbmUsIG5laWdoYm9yaG9vZCwgKGVycm9yLCByZXN0YXVyYW50cykgPT4ge1xyXG4gICAgICAgIGlmIChlcnJvcikgeyAvLyBHb3QgYW4gZXJyb3IhXHJcbiAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoZXJyb3IpO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIHJlc2V0UmVzdGF1cmFudHMocmVzdGF1cmFudHMpO1xyXG4gICAgICAgICAgICBmaWxsUmVzdGF1cmFudHNIVE1MKCk7XHJcbiAgICAgICAgfVxyXG4gICAgfSlcclxufVxyXG5cclxuLyoqXHJcbiAqIENsZWFyIGN1cnJlbnQgcmVzdGF1cmFudHMsIHRoZWlyIEhUTUwgYW5kIHJlbW92ZSB0aGVpciBtYXAgbWFya2Vycy5cclxuICovXHJcbnJlc2V0UmVzdGF1cmFudHMgPSAocmVzdGF1cmFudHMpID0+IHtcclxuICAgIC8vIFJlbW92ZSBhbGwgcmVzdGF1cmFudHNcclxuICAgIHNlbGYucmVzdGF1cmFudHMgPSBbXTtcclxuICAgIGNvbnN0IHVsID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3Jlc3RhdXJhbnRzLWxpc3QnKTtcclxuICAgIHVsLmlubmVySFRNTCA9ICcnO1xyXG5cclxuICAgIC8vIFJlbW92ZSBhbGwgbWFwIG1hcmtlcnNcclxuICAgIGlmIChzZWxmLm1hcmtlcnMpIHtcclxuICAgICAgICBzZWxmLm1hcmtlcnMuZm9yRWFjaChtYXJrZXIgPT4gbWFya2VyLnJlbW92ZSgpKTtcclxuICAgIH1cclxuICAgIHNlbGYubWFya2VycyA9IFtdO1xyXG4gICAgc2VsZi5yZXN0YXVyYW50cyA9IHJlc3RhdXJhbnRzO1xyXG59XHJcblxyXG4vKipcclxuICogQ3JlYXRlIGFsbCByZXN0YXVyYW50cyBIVE1MIGFuZCBhZGQgdGhlbSB0byB0aGUgd2VicGFnZS5cclxuICovXHJcbmZpbGxSZXN0YXVyYW50c0hUTUwgPSAocmVzdGF1cmFudHMgPSBzZWxmLnJlc3RhdXJhbnRzKSA9PiB7XHJcbiAgICBjb25zdCB1bCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdyZXN0YXVyYW50cy1saXN0Jyk7XHJcbiAgICByZXN0YXVyYW50cy5mb3JFYWNoKHJlc3RhdXJhbnQgPT4ge1xyXG4gICAgICAgIHVsLmFwcGVuZChjcmVhdGVSZXN0YXVyYW50SFRNTChyZXN0YXVyYW50KSk7XHJcbiAgICB9KTtcclxuICAgIGFkZE1hcmtlcnNUb01hcCgpO1xyXG59XHJcblxyXG4vKipcclxuICogQ3JlYXRlIHJlc3RhdXJhbnQgSFRNTC5cclxuICovXHJcbmNyZWF0ZVJlc3RhdXJhbnRIVE1MID0gKHJlc3RhdXJhbnQpID0+IHtcclxuICAgIGNvbnN0IGxpID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnbGknKTtcclxuICAgIGxpLnNldEF0dHJpYnV0ZSgndGFiaW5kZXgnLCAwKTtcclxuXHJcbiAgICBjb25zdCBpbWFnZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2ltZycpO1xyXG4gICAgaW1hZ2Uuc3JjID0gREJIZWxwZXIuaW1hZ2VVcmxGb3JSZXN0YXVyYW50KHJlc3RhdXJhbnQpO1xyXG4gICAgaW1hZ2UuY2xhc3NOYW1lID0gJ3Jlc3RhdXJhbnQtaW1nJztcclxuICAgIGlmIChpbWFnZS5zcmMgPT0gYGh0dHA6Ly9sb2NhbGhvc3Q6ODA4MC9uby1pbWFnZWApIHtcclxuICAgICAgICBpbWFnZS5zcmMgPSAnJztcclxuICAgICAgICBpbWFnZS5jbGFzc0xpc3QuYWRkKCdmYWxsYmFjay1pbWFnZS1pY29uJyk7XHJcbiAgICB9XHJcbiAgICBpbWFnZS5hbHQgPSBgJHtyZXN0YXVyYW50Lm5hbWV9IHJlc3RhdXJhbnQgaW1hZ2VgO1xyXG4gICAgaW1hZ2Uuc2V0QXR0cmlidXRlKCd0YWJpbmRleCcsIDApO1xyXG4gICAgbGkuYXBwZW5kKGltYWdlKTtcclxuXHJcbiAgICBjb25zdCBkZXRhaWxzID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XHJcbiAgICBkZXRhaWxzLmNsYXNzTmFtZSA9ICdyZXN0YXVyYW50LWRldGFpbHMnO1xyXG4gICAgbGkuYXBwZW5kKGRldGFpbHMpO1xyXG5cclxuICAgIGNvbnN0IG5hbWUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdoMicpO1xyXG4gICAgbmFtZS5pbm5lckhUTUwgPSByZXN0YXVyYW50Lm5hbWU7XHJcbiAgICBuYW1lLnNldEF0dHJpYnV0ZSgndGFiaW5kZXgnLCAwKTtcclxuICAgIGRldGFpbHMuYXBwZW5kKG5hbWUpO1xyXG5cclxuICAgIGNvbnN0IG5laWdoYm9yaG9vZCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3AnKTtcclxuICAgIG5laWdoYm9yaG9vZC5pbm5lckhUTUwgPSByZXN0YXVyYW50Lm5laWdoYm9yaG9vZDtcclxuICAgIG5laWdoYm9yaG9vZC5zZXRBdHRyaWJ1dGUoJ3RhYmluZGV4JywgMCk7XHJcbiAgICBkZXRhaWxzLmFwcGVuZChuZWlnaGJvcmhvb2QpO1xyXG5cclxuICAgIGNvbnN0IGFkZHJlc3MgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdwJyk7XHJcbiAgICBhZGRyZXNzLmNsYXNzTmFtZSA9ICdyZXN0LWFkZHJlc3MnO1xyXG4gICAgYWRkcmVzcy5pbm5lckhUTUwgPSBgPGkgY2xhc3M9J2ZhIGZhLW1hcC1tYXJrZXInPjwvaT5gICsgcmVzdGF1cmFudC5hZGRyZXNzO1xyXG4gICAgYWRkcmVzcy5zZXRBdHRyaWJ1dGUoJ3RhYmluZGV4JywgMCk7XHJcbiAgICBkZXRhaWxzLmFwcGVuZChhZGRyZXNzKTtcclxuXHJcbiAgICBjb25zdCBtb3JlID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnYScpO1xyXG4gICAgbW9yZS5pbm5lckhUTUwgPSAnVmlldyBEZXRhaWxzJztcclxuICAgIG1vcmUuaHJlZiA9IERCSGVscGVyLnVybEZvclJlc3RhdXJhbnQocmVzdGF1cmFudCk7XHJcbiAgICBtb3JlLnNldEF0dHJpYnV0ZSgnYXJpYS1sYWJlbCcsIGBWaWV3IGRldGFpbHMgb2YgJHtyZXN0YXVyYW50Lm5hbWV9YClcclxuICAgIGRldGFpbHMuYXBwZW5kKG1vcmUpXHJcblxyXG4gICAgcmV0dXJuIGxpXHJcbn1cclxuXHJcbi8qKlxyXG4gKiBBZGQgbWFya2VycyBmb3IgY3VycmVudCByZXN0YXVyYW50cyB0byB0aGUgbWFwLlxyXG4gKi9cclxuYWRkTWFya2Vyc1RvTWFwID0gKHJlc3RhdXJhbnRzID0gc2VsZi5yZXN0YXVyYW50cykgPT4ge1xyXG4gICAgcmVzdGF1cmFudHMuZm9yRWFjaChyZXN0YXVyYW50ID0+IHtcclxuICAgICAgICAvLyBBZGQgbWFya2VyIHRvIHRoZSBtYXBcclxuICAgICAgICBjb25zdCBtYXJrZXIgPSBEQkhlbHBlci5tYXBNYXJrZXJGb3JSZXN0YXVyYW50KHJlc3RhdXJhbnQsIHNlbGYubmV3TWFwKTtcclxuICAgICAgICBtYXJrZXIub24oXCJjbGlja1wiLCBvbkNsaWNrKTtcclxuICAgICAgICBmdW5jdGlvbiBvbkNsaWNrKCkge1xyXG4gICAgICAgICAgICB3aW5kb3cubG9jYXRpb24uaHJlZiA9IG1hcmtlci5vcHRpb25zLnVybDtcclxuICAgICAgICB9XHJcbiAgICAgICAgc2VsZi5tYXJrZXJzLnB1c2gobWFya2VyKTtcclxuICAgIH0pO1xyXG5cclxufVxyXG4vKiBhZGRNYXJrZXJzVG9NYXAgPSAocmVzdGF1cmFudHMgPSBzZWxmLnJlc3RhdXJhbnRzKSA9PiB7XHJcbiAgcmVzdGF1cmFudHMuZm9yRWFjaChyZXN0YXVyYW50ID0+IHtcclxuICAgIC8vIEFkZCBtYXJrZXIgdG8gdGhlIG1hcFxyXG4gICAgY29uc3QgbWFya2VyID0gREJIZWxwZXIubWFwTWFya2VyRm9yUmVzdGF1cmFudChyZXN0YXVyYW50LCBzZWxmLm1hcCk7XHJcbiAgICBnb29nbGUubWFwcy5ldmVudC5hZGRMaXN0ZW5lcihtYXJrZXIsICdjbGljaycsICgpID0+IHtcclxuICAgICAgd2luZG93LmxvY2F0aW9uLmhyZWYgPSBtYXJrZXIudXJsXHJcbiAgICB9KTtcclxuICAgIHNlbGYubWFya2Vycy5wdXNoKG1hcmtlcik7XHJcbiAgfSk7XHJcbn0gKi9cclxuXHJcblxyXG4vKiBNYW5hZ2UgZm9jdXMgYW5kIHRhYmluZGV4IG9uIGZpbHRlciBvcHRpb25zICovXHJcblxyXG5cclxuXHJcbiIsImxldCByZXN0YXVyYW50O1xudmFyIG5ld01hcDtcblxuLyoqXG4gKiBJbml0aWFsaXplIG1hcCBhcyBzb29uIGFzIHRoZSBwYWdlIGlzIGxvYWRlZC5cbiAqL1xuZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignRE9NQ29udGVudExvYWRlZCcsIChldmVudCkgPT4ge1xuICAgIGluaXRNYXAoKTtcbn0pO1xuXG4vKipcbiAqIEluaXRpYWxpemUgbGVhZmxldCBtYXBcbiAqL1xuaW5pdE1hcCA9ICgpID0+IHtcbiAgICBmZXRjaFJlc3RhdXJhbnRGcm9tVVJMKChlcnJvciwgcmVzdGF1cmFudCkgPT4ge1xuICAgICAgICBpZiAoZXJyb3IpIHsgLy8gR290IGFuIGVycm9yIVxuICAgICAgICAgICAgY29uc29sZS5lcnJvcihlcnJvcik7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBzZWxmLm5ld01hcCA9IEwubWFwKCdtYXAnLCB7XG4gICAgICAgICAgICAgICAgY2VudGVyOiBbcmVzdGF1cmFudC5sYXRsbmcubGF0LCByZXN0YXVyYW50LmxhdGxuZy5sbmddLFxuICAgICAgICAgICAgICAgIHpvb206IDE2LFxuICAgICAgICAgICAgICAgIHNjcm9sbFdoZWVsWm9vbTogZmFsc2VcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgTC50aWxlTGF5ZXIoJ2h0dHBzOi8vYXBpLnRpbGVzLm1hcGJveC5jb20vdjQve2lkfS97en0ve3h9L3t5fS5qcGc3MD9hY2Nlc3NfdG9rZW49e21hcGJveFRva2VufScsIHtcbiAgICAgICAgICAgICAgICBtYXBib3hUb2tlbjogJ3BrLmV5SjFJam9pYVcxMmNHNHlNaUlzSW1FaU9pSmphbWwyYm5seWNHRXhNM0Z1TTNGeGJUYzBlV00yTkhWMkluMC5FU3MzNzR4TjNndUZBR09fMUVQZG1RJyxcbiAgICAgICAgICAgICAgICBtYXhab29tOiAxOCxcbiAgICAgICAgICAgICAgICBhdHRyaWJ1dGlvbjogJ01hcCBkYXRhICZjb3B5OyA8YSBocmVmPVwiaHR0cHM6Ly93d3cub3BlbnN0cmVldG1hcC5vcmcvXCI+T3BlblN0cmVldE1hcDwvYT4gY29udHJpYnV0b3JzLCAnICtcbiAgICAgICAgICAgICAgICAnPGEgaHJlZj1cImh0dHBzOi8vY3JlYXRpdmVjb21tb25zLm9yZy9saWNlbnNlcy9ieS1zYS8yLjAvXCI+Q0MtQlktU0E8L2E+LCAnICtcbiAgICAgICAgICAgICAgICAnSW1hZ2VyeSDCqSA8YSBocmVmPVwiaHR0cHM6Ly93d3cubWFwYm94LmNvbS9cIj5NYXBib3g8L2E+JyxcbiAgICAgICAgICAgICAgICBpZDogJ21hcGJveC5zdHJlZXRzJ1xuICAgICAgICAgICAgfSkuYWRkVG8obmV3TWFwKTtcbiAgICAgICAgICAgIGZpbGxCcmVhZGNydW1iKCk7XG4gICAgICAgICAgICBEQkhlbHBlci5tYXBNYXJrZXJGb3JSZXN0YXVyYW50KHNlbGYucmVzdGF1cmFudCwgc2VsZi5uZXdNYXApO1xuICAgICAgICB9XG4gICAgfSk7XG59XG5cbi8qIHdpbmRvdy5pbml0TWFwID0gKCkgPT4ge1xuICBmZXRjaFJlc3RhdXJhbnRGcm9tVVJMKChlcnJvciwgcmVzdGF1cmFudCkgPT4ge1xuICAgIGlmIChlcnJvcikgeyAvLyBHb3QgYW4gZXJyb3IhXG4gICAgICBjb25zb2xlLmVycm9yKGVycm9yKTtcbiAgICB9IGVsc2Uge1xuICAgICAgc2VsZi5tYXAgPSBuZXcgZ29vZ2xlLm1hcHMuTWFwKGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdtYXAnKSwge1xuICAgICAgICB6b29tOiAxNixcbiAgICAgICAgY2VudGVyOiByZXN0YXVyYW50LmxhdGxuZyxcbiAgICAgICAgc2Nyb2xsd2hlZWw6IGZhbHNlXG4gICAgICB9KTtcbiAgICAgIGZpbGxCcmVhZGNydW1iKCk7XG4gICAgICBEQkhlbHBlci5tYXBNYXJrZXJGb3JSZXN0YXVyYW50KHNlbGYucmVzdGF1cmFudCwgc2VsZi5tYXApO1xuICAgIH1cbiAgfSk7XG59ICovXG5cbi8qKlxuICogR2V0IGN1cnJlbnQgcmVzdGF1cmFudCBmcm9tIHBhZ2UgVVJMLlxuICovXG5mZXRjaFJlc3RhdXJhbnRGcm9tVVJMID0gKGNhbGxiYWNrKSA9PiB7XG4gICAgaWYgKHNlbGYucmVzdGF1cmFudCkgeyAvLyByZXN0YXVyYW50IGFscmVhZHkgZmV0Y2hlZCFcbiAgICAgICAgY2FsbGJhY2sobnVsbCwgc2VsZi5yZXN0YXVyYW50KVxuICAgICAgICByZXR1cm47XG4gICAgfVxuICAgIGNvbnN0IGlkID0gZ2V0UGFyYW1ldGVyQnlOYW1lKCdpZCcpO1xuICAgIGlmICghaWQpIHsgLy8gbm8gaWQgZm91bmQgaW4gVVJMXG4gICAgICAgIGVycm9yID0gJ05vIHJlc3RhdXJhbnQgaWQgaW4gVVJMJ1xuICAgICAgICBjYWxsYmFjayhlcnJvciwgbnVsbCk7XG4gICAgfSBlbHNlIHtcbiAgICAgICAgREJIZWxwZXIuZmV0Y2hSZXN0YXVyYW50QnlJZChpZCwgKGVycm9yLCByZXN0YXVyYW50KSA9PiB7XG4gICAgICAgICAgICBzZWxmLnJlc3RhdXJhbnQgPSByZXN0YXVyYW50O1xuICAgICAgICAgICAgaWYgKCFyZXN0YXVyYW50KSB7XG4gICAgICAgICAgICAgICAgY29uc29sZS5lcnJvcihlcnJvcik7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZmlsbFJlc3RhdXJhbnRIVE1MKCk7XG4gICAgICAgICAgICBjYWxsYmFjayhudWxsLCByZXN0YXVyYW50KVxuICAgICAgICB9KTtcbiAgICB9XG59XG5cbi8qKlxuICogQ3JlYXRlIHJlc3RhdXJhbnQgSFRNTCBhbmQgYWRkIGl0IHRvIHRoZSB3ZWJwYWdlXG4gKi9cbmZpbGxSZXN0YXVyYW50SFRNTCA9IChyZXN0YXVyYW50ID0gc2VsZi5yZXN0YXVyYW50KSA9PiB7XG4gICAgY29uc3QgbmFtZSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdyZXN0YXVyYW50LW5hbWUnKTtcbiAgICBuYW1lLmlubmVySFRNTCA9IHJlc3RhdXJhbnQubmFtZTtcblxuICAgIGNvbnN0IGFkZHJlc3MgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncmVzdGF1cmFudC1hZGRyZXNzJyk7XG4gICAgYWRkcmVzcy5pbm5lckhUTUwgPSBgPGkgY2xhc3M9J2ZhIGZhLW1hcC1tYXJrZXInPjwvaT5gICsgcmVzdGF1cmFudC5hZGRyZXNzO1xuXG4gICAgY29uc3QgaW1hZ2UgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncmVzdGF1cmFudC1pbWcnKTtcbiAgICBpbWFnZS5jbGFzc05hbWUgPSAncmVzdGF1cmFudC1pbWcnXG4gICAgaW1hZ2Uuc3JjID0gREJIZWxwZXIuaW1hZ2VVcmxGb3JSZXN0YXVyYW50KHJlc3RhdXJhbnQpO1xuICAgIGlmIChpbWFnZS5zcmMgPT0gYGh0dHA6Ly9sb2NhbGhvc3Q6ODA4MC9uby1pbWFnZWApIHtcbiAgICAgICAgaW1hZ2UuY2xhc3NMaXN0LmFkZCgnZmFsbGJhY2staW1hZ2UtaWNvbicpO1xuICAgIH1cbiAgICBpbWFnZS5hbHQgPSBgJHtyZXN0YXVyYW50Lm5hbWV9IHJlc3RhdXJhbnQgaW1hZ2VgO1xuXG4gICAgY29uc3QgY3Vpc2luZSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdyZXN0YXVyYW50LWN1aXNpbmUnKTtcbiAgICBjdWlzaW5lLmlubmVySFRNTCA9IHJlc3RhdXJhbnQuY3Vpc2luZV90eXBlO1xuXG4gICAgLy8gZmlsbCBvcGVyYXRpbmcgaG91cnNcbiAgICBpZiAocmVzdGF1cmFudC5vcGVyYXRpbmdfaG91cnMpIHtcbiAgICAgICAgZmlsbFJlc3RhdXJhbnRIb3Vyc0hUTUwoKTtcbiAgICB9XG4gICAgLy8gZmlsbCByZXZpZXdzXG4gICAgZmlsbFJldmlld3NIVE1MKCk7XG59XG5cbi8qKlxuICogQ3JlYXRlIHJlc3RhdXJhbnQgb3BlcmF0aW5nIGhvdXJzIEhUTUwgdGFibGUgYW5kIGFkZCBpdCB0byB0aGUgd2VicGFnZS5cbiAqL1xuZmlsbFJlc3RhdXJhbnRIb3Vyc0hUTUwgPSAob3BlcmF0aW5nSG91cnMgPSBzZWxmLnJlc3RhdXJhbnQub3BlcmF0aW5nX2hvdXJzKSA9PiB7XG4gICAgY29uc3QgaG91cnMgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncmVzdGF1cmFudC1ob3VycycpO1xuICAgIGZvciAobGV0IGtleSBpbiBvcGVyYXRpbmdIb3Vycykge1xuICAgICAgICBjb25zdCByb3cgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCd0cicpO1xuXG4gICAgICAgIGNvbnN0IGRheSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3RkJyk7XG4gICAgICAgIGRheS5pbm5lckhUTUwgPSBrZXk7XG4gICAgICAgIHJvdy5hcHBlbmRDaGlsZChkYXkpO1xuXG4gICAgICAgIGNvbnN0IHRpbWUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCd0ZCcpO1xuICAgICAgICB0aW1lLmlubmVySFRNTCA9IG9wZXJhdGluZ0hvdXJzW2tleV07XG4gICAgICAgIHJvdy5hcHBlbmRDaGlsZCh0aW1lKTtcblxuICAgICAgICBob3Vycy5hcHBlbmRDaGlsZChyb3cpO1xuICAgIH1cbn1cblxuLyoqXG4gKiBDcmVhdGUgYWxsIHJldmlld3MgSFRNTCBhbmQgYWRkIHRoZW0gdG8gdGhlIHdlYnBhZ2UuXG4gKi9cbmZpbGxSZXZpZXdzSFRNTCA9IChyZXZpZXdzID0gc2VsZi5yZXN0YXVyYW50LnJldmlld3MpID0+IHtcbiAgICBjb25zdCBjb250YWluZXIgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncmV2aWV3cy1jb250YWluZXInKTtcbiAgICBjb25zdCB0aXRsZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2gyJyk7XG4gICAgdGl0bGUuaW5uZXJIVE1MID0gJ1Jldmlld3MnO1xuICAgIHRpdGxlLnNldEF0dHJpYnV0ZSgndGFiaW5kZXgnLCAwKTtcbiAgICBjb250YWluZXIuYXBwZW5kQ2hpbGQodGl0bGUpO1xuXG4gICAgaWYgKCFyZXZpZXdzKSB7XG4gICAgICAgIGNvbnN0IG5vUmV2aWV3cyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3AnKTtcbiAgICAgICAgbm9SZXZpZXdzLmlubmVySFRNTCA9ICdObyByZXZpZXdzIHlldCEnO1xuICAgICAgICBub1Jldmlld3Muc2V0QXR0cmlidXRlKCd0YWJpbmRleCcsIDApO1xuICAgICAgICBjb250YWluZXIuYXBwZW5kQ2hpbGQobm9SZXZpZXdzKTtcbiAgICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICBjb25zdCB1bCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdyZXZpZXdzLWxpc3QnKTtcbiAgICByZXZpZXdzLmZvckVhY2gocmV2aWV3ID0+IHtcbiAgICAgICAgdWwuYXBwZW5kQ2hpbGQoY3JlYXRlUmV2aWV3SFRNTChyZXZpZXcpKTtcbiAgICB9KTtcbiAgICBjb250YWluZXIuYXBwZW5kQ2hpbGQodWwpO1xufVxuXG4vKipcbiAqIENyZWF0ZSByZXZpZXcgSFRNTCBhbmQgYWRkIGl0IHRvIHRoZSB3ZWJwYWdlLlxuICovXG5jcmVhdGVSZXZpZXdIVE1MID0gKHJldmlldykgPT4ge1xuICAgIGNvbnN0IGxpID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnbGknKTtcbiAgICBsaS5zZXRBdHRyaWJ1dGUoJ3RhYmluZGV4JywgMCk7XG4gICAgY29uc3QgbmFtZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3AnKTtcbiAgICBuYW1lLmNsYXNzTmFtZSA9ICdyZXZpZXctdXNlcic7XG4gICAgbmFtZS5pbm5lckhUTUwgPSBgPGkgY2xhc3M9J2ZhIGZhLXVzZXInPjwvaT5gICsgcmV2aWV3Lm5hbWU7XG4gICAgbmFtZS5zZXRBdHRyaWJ1dGUoJ3RhYmluZGV4JywgMCk7XG4gICAgbGkuYXBwZW5kQ2hpbGQobmFtZSk7XG5cbiAgICBjb25zdCBkYXRlID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgncCcpO1xuICAgIGRhdGUuY2xhc3NOYW1lID0gJ3Jldmlldy1kYXRlJztcbiAgICBkYXRlLmlubmVySFRNTCA9IGA8aSBjbGFzcz0nZmEgZmEtY2FsZW5kYXInPjwvaT5gICsgcmV2aWV3LmRhdGU7XG4gICAgZGF0ZS5zZXRBdHRyaWJ1dGUoJ3RhYmluZGV4JywgMCk7XG4gICAgbGkuYXBwZW5kQ2hpbGQoZGF0ZSk7XG5cbiAgICBjb25zdCByYXRpbmcgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdwJyk7XG4gICAgcmF0aW5nLmNsYXNzTmFtZSA9ICdyZXZpZXctcmF0aW5nJztcbiAgICAvLyByYXRpbmcuaW5uZXJIVE1MID0gYDxpIGNsYXNzPSdmYSBmYS1zdGFyJz48L2k+UmF0aW5nOiAke3Jldmlldy5yYXRpbmd9YDtcbiAgICByYXRpbmcuaW5uZXJIVE1MID0gJyc7XG4gICAgcmF0aW5nLnNldEF0dHJpYnV0ZSgndGFiaW5kZXgnLCAwKTtcbiAgICByYXRpbmcuc2V0QXR0cmlidXRlKCdhcmlhLWxhYmVsJywgYFJhdGluZzogJHtyZXZpZXcucmF0aW5nfSBvdXQgb2YgNSBzdGFyc2ApO1xuXG4gICAgLy8gRmlsbGVkIHN0YXIgZm9yIHJhdGluZ1xuICAgIGZvciAoaT0wOyBpPHJldmlldy5yYXRpbmc7IGkrKykge1xuICAgICAgICBsZXQgc3RhciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2knKTtcbiAgICAgICAgc3Rhci5jbGFzc05hbWUgPSAnZmEgZmEtc3Rhcic7XG4gICAgICAgIHJhdGluZy5hcHBlbmRDaGlsZChzdGFyKTtcbiAgICB9XG4gICAgZm9yIChpPXJldmlldy5yYXRpbmc7IGk8NTsgaSsrKSB7XG4gICAgICAgIGxldCBzdGFyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnaScpO1xuICAgICAgICBzdGFyLmNsYXNzTmFtZSA9ICdmYXIgZmEtc3Rhcic7XG4gICAgICAgIHJhdGluZy5hcHBlbmRDaGlsZChzdGFyKTtcbiAgICB9XG4gICAgbGkuYXBwZW5kQ2hpbGQocmF0aW5nKTtcblxuICAgIGNvbnN0IGNvbW1lbnRzID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgncCcpO1xuICAgIGNvbW1lbnRzLmNsYXNzTmFtZSA9ICdyZXZpZXctY29tbWVudHMnO1xuICAgIGNvbW1lbnRzLmlubmVySFRNTCA9IHJldmlldy5jb21tZW50cztcbiAgICBjb21tZW50cy5zZXRBdHRyaWJ1dGUoJ3RhYmluZGV4JywgMCk7XG4gICAgbGkuYXBwZW5kQ2hpbGQoY29tbWVudHMpO1xuXG4gICAgcmV0dXJuIGxpO1xufVxuXG4vKipcbiAqIEFkZCByZXN0YXVyYW50IG5hbWUgdG8gdGhlIGJyZWFkY3J1bWIgbmF2aWdhdGlvbiBtZW51XG4gKi9cbmZpbGxCcmVhZGNydW1iID0gKHJlc3RhdXJhbnQ9c2VsZi5yZXN0YXVyYW50KSA9PiB7XG4gICAgY29uc3QgYnJlYWRjcnVtYiA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdicmVhZGNydW1iJyk7XG4gICAgY29uc3QgbGkgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdsaScpO1xuICAgIGxpLmlubmVySFRNTCA9IHJlc3RhdXJhbnQubmFtZTtcbiAgICBicmVhZGNydW1iLmFwcGVuZENoaWxkKGxpKTtcbn1cblxuLyoqXG4gKiBHZXQgYSBwYXJhbWV0ZXIgYnkgbmFtZSBmcm9tIHBhZ2UgVVJMLlxuICovXG5nZXRQYXJhbWV0ZXJCeU5hbWUgPSAobmFtZSwgdXJsKSA9PiB7XG4gICAgaWYgKCF1cmwpXG4gICAgICAgIHVybCA9IHdpbmRvdy5sb2NhdGlvbi5ocmVmO1xuICAgIG5hbWUgPSBuYW1lLnJlcGxhY2UoL1tcXFtcXF1dL2csICdcXFxcJCYnKTtcbiAgICBjb25zdCByZWdleCA9IG5ldyBSZWdFeHAoYFs/Jl0ke25hbWV9KD0oW14mI10qKXwmfCN8JClgKSxcbiAgICAgICAgcmVzdWx0cyA9IHJlZ2V4LmV4ZWModXJsKTtcbiAgICBpZiAoIXJlc3VsdHMpXG4gICAgICAgIHJldHVybiBudWxsO1xuICAgIGlmICghcmVzdWx0c1syXSlcbiAgICAgICAgcmV0dXJuICcnO1xuICAgIHJldHVybiBkZWNvZGVVUklDb21wb25lbnQocmVzdWx0c1syXS5yZXBsYWNlKC9cXCsvZywgJyAnKSk7XG59XG4iXSwiZmlsZSI6ImFwcC1taW4uanMifQ==
